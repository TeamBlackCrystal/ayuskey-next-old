(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[4529],{2127:(e,t,s)=>{var a=s(23645)((function(e){return e[1]}));a.push([e.id,"",""]),e.exports=a},31064:(e,t,s)=>{"use strict";s.d(t,{a:()=>i});var a=s(27328),r=s(10192),o=s(37200);function i(e){let t=0;return{USER_ID:o.$i?a.values.STR(o.$i.id):a.values.NULL,USER_NAME:o.$i?a.values.STR(o.$i.name):a.values.NULL,USER_USERNAME:o.$i?a.values.STR(o.$i.username):a.values.NULL,"Mk:dialog":a.values.FN_NATIVE((async([e,t,s])=>{await r.WZ({type:s?s.value:"info",title:e.value,text:t.value})})),"Mk:confirm":a.values.FN_NATIVE((async([e,t,s])=>(await r.WZ({type:s?s.value:"question",showCancelButton:!0,title:e.value,text:t.value})).canceled?a.values.FALSE:a.values.TRUE)),"Mk:api":a.values.FN_NATIVE((async([s,o,i])=>{if(i&&a.utils.assertString(i),t++,t>16)return a.values.NULL;const l=await r.hi(s.value,a.utils.valToJs(o),i?i.value:e.token||null);return a.utils.jsToVal(l)})),"Mk:save":a.values.FN_NATIVE((([t,s])=>(a.utils.assertString(t),localStorage.setItem("aiscript:"+e.storageKey+":"+t.value,JSON.stringify(a.utils.valToJs(s))),a.values.NULL))),"Mk:load":a.values.FN_NATIVE((([t])=>(a.utils.assertString(t),a.utils.jsToVal(JSON.parse(localStorage.getItem("aiscript:"+e.storageKey+":"+t.value))))))}}},46397:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(55393),r=s(51084),o=s(10192);function i(e){return(0,a.defineComponent)({props:{widget:{type:Object,required:!1},settingCallback:{required:!1}},emits:["updateProps"],data(){return{props:this.widget?JSON.parse(JSON.stringify(this.widget.data)):{},save:(0,r.P)(3e3,(()=>{this.$emit("updateProps",this.props)}))}},computed:{id(){return this.widget?this.widget.id:null}},created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()}),{deep:!0}),this.settingCallback&&this.settingCallback(this.setting)},methods:{mergeProps(){if(e.props){const t=e.props();for(const e of Object.keys(t))this.props.hasOwnProperty(e)||(this.props[e]=t[e].default)}},async setting(){const t=e.props();for(const e of Object.keys(t))t[e].default=this.props[e];const{canceled:s,result:a}=await o.cr(e.name,t);if(!s){for(const e of Object.keys(a))this.props[e]=a[e];this.save()}}}})}},45292:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(55393);const r=(0,a.withScopeId)("data-v-31c2d5eb");(0,a.pushScopeId)("data-v-31c2d5eb");const o={class:"mkw-button"};(0,a.popScopeId)();const i=r(((e,t,s,i,l,n)=>{const u=(0,a.resolveComponent)("MkButton");return(0,a.openBlock)(),(0,a.createBlock)("div",o,[(0,a.createVNode)(u,{primary:e.props.colored,full:"",onClick:e.run},{default:r((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.props.label),1)])),_:1},8,["primary","onClick"])])}));var l=s(46397),n=s(42453),u=s(10192),c=s(27328),p=s(31064);const d=(0,l.Z)({name:"button",props:()=>({label:{type:"string",default:"BUTTON"},colored:{type:"boolean",default:!0},script:{type:"string",multiline:!0,default:'Mk:dialog("hello" "world")'}})}),v=(0,a.defineComponent)({components:{MkButton:n.Z},extends:d,data:()=>({}),methods:{async run(){var e;const t=new c.AiScript((0,p.a)({storageKey:"widget",token:null===(e=this.$i)||void 0===e?void 0:e.token}),{in:e=>new Promise((t=>{u.WZ({title:e,input:{}}).then((({canceled:e,result:s})=>{t(s)}))})),out:e=>{},log:(e,t)=>{}});let s;try{s=(0,c.parse)(this.props.script)}catch(e){return void u.WZ({type:"error",text:"Syntax error :("})}try{await t.exec(s)}catch(e){u.WZ({type:"error",text:e})}}}});s(11386);v.render=i,v.__scopeId="data-v-31c2d5eb";const h=v},11386:(e,t,s)=>{var a=s(2127);"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,s(45346).Z)("09015c4c",a,!0,{})},63906:()=>{}}]);