(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[5869,156,5485],{62960:(e,t,a)=>{var i=a(23645)((function(e){return e[1]}));i.push([e.id,".container-toggle-enter-active[data-v-1dbdaf33],.container-toggle-leave-active[data-v-1dbdaf33]{overflow-y:hidden;transition:opacity .5s,height .5s!important}.container-toggle-enter-from[data-v-1dbdaf33],.container-toggle-leave-to[data-v-1dbdaf33]{opacity:0}.ukygtjoj[data-v-1dbdaf33]{position:relative;overflow:hidden}.ukygtjoj.naked[data-v-1dbdaf33]{background:transparent!important;box-shadow:none!important}.ukygtjoj.scrollable[data-v-1dbdaf33]{display:flex;flex-direction:column}.ukygtjoj.scrollable>div[data-v-1dbdaf33]{overflow:auto}.ukygtjoj>header[data-v-1dbdaf33]{position:relative;color:var(--panelHeaderFg);background:var(--panelHeaderBg);box-shadow:0 1px 0 0 var(--panelHeaderDivider);z-index:2;line-height:1.4em}.ukygtjoj>header>.title[data-v-1dbdaf33]{margin:0;padding:12px 16px}.ukygtjoj>header>.title[data-v-1dbdaf33]> [data-icon]{margin-right:6px}.ukygtjoj>header>.title[data-v-1dbdaf33]:empty{display:none}.ukygtjoj>header>.sub[data-v-1dbdaf33]{position:absolute;z-index:2;top:0;right:0;height:100%}.ukygtjoj>header>.sub[data-v-1dbdaf33]> button{width:42px;height:100%}.ukygtjoj>div[data-v-1dbdaf33]> ._content{padding:24px}.ukygtjoj>div[data-v-1dbdaf33]> ._content+._content{border-top:1px solid var(--divider)}.ukygtjoj.max-width_380px>header>.title[data-v-1dbdaf33]{padding:8px 10px;font-size:.9em}.ukygtjoj.max-width_380px>div[data-v-1dbdaf33]> ._content{padding:16px}._forceContainerFull_ .ukygtjoj>header>.title[data-v-1dbdaf33]{padding:12px 16px!important}._forceContainerFull_.ukygtjoj>header>.title[data-v-1dbdaf33]{padding:12px 16px!important}",""]),e.exports=i},26051:(e,t,a)=>{var i=a(23645)((function(e){return e[1]}));i.push([e.id,'.eiipwacr[data-v-bcae1c0a]{position:relative;margin:32px 0}.eiipwacr[data-v-bcae1c0a]:not(.inline):first-child{margin-top:8px}.eiipwacr[data-v-bcae1c0a]:not(.inline):last-child{margin-bottom:8px}.eiipwacr>.icon[data-v-bcae1c0a]{position:absolute;top:0;left:0;width:24px;text-align:center;line-height:32px}.eiipwacr>.icon:not(:empty)+.input[data-v-bcae1c0a]{margin-left:28px}.eiipwacr>.input[data-v-bcae1c0a]{display:flex;position:relative}.eiipwacr>.input[data-v-bcae1c0a]:before{content:"";display:block;position:absolute;bottom:0;left:0;right:0;height:1px;background:var(--inputBorder)}.eiipwacr>.input[data-v-bcae1c0a]:after{content:"";display:block;position:absolute;bottom:0;left:0;right:0;height:2px;background:var(--accent);opacity:0;transform:scaleX(.12);transition:border .3s cubic-bezier(.4,0,.2,1),opacity .3s cubic-bezier(.4,0,.2,1),transform .3s cubic-bezier(.4,0,.2,1);will-change:border opacity transform}.eiipwacr>.input>.label[data-v-bcae1c0a]{position:absolute;top:0;left:0;transition:.4s cubic-bezier(.25,.8,.25,1);transition-duration:.3s;font-size:1em;line-height:32px;pointer-events:none;transform-origin:top left;transform:scale(1)}.eiipwacr>.input>select[data-v-bcae1c0a]{display:block;flex:1;width:100%;padding:0;font:inherit;font-weight:400;font-size:1em;height:32px;background:none;border:none;border-radius:0;outline:none;box-shadow:none;appearance:none;-webkit-appearance:none;color:var(--fg)}.eiipwacr>.input>select optgroup[data-v-bcae1c0a],.eiipwacr>.input>select option[data-v-bcae1c0a]{color:var(--fg);background:var(--bg)}.eiipwacr>.input>.prefix[data-v-bcae1c0a],.eiipwacr>.input>.suffix[data-v-bcae1c0a]{display:block;align-self:center;justify-self:center;font-size:1em;line-height:32px;color:var(--inputLabel);pointer-events:none}.eiipwacr>.input>.prefix[data-v-bcae1c0a]:empty,.eiipwacr>.input>.suffix[data-v-bcae1c0a]:empty{display:none}.eiipwacr>.input>.prefix>*[data-v-bcae1c0a],.eiipwacr>.input>.suffix>*[data-v-bcae1c0a]{display:block;min-width:16px}.eiipwacr>.input>.prefix[data-v-bcae1c0a]{padding-right:4px}.eiipwacr>.input>.suffix[data-v-bcae1c0a]{padding-left:4px}.eiipwacr>.text[data-v-bcae1c0a]{margin:6px 0;font-size:.8em}.eiipwacr>.text[data-v-bcae1c0a]:empty{display:none}.eiipwacr>.text *[data-v-bcae1c0a]{margin:0}.eiipwacr.focused>.input[data-v-bcae1c0a]:after{opacity:1;transform:scaleX(1)}.eiipwacr.focused>.input>.label[data-v-bcae1c0a]{color:var(--accent)}.eiipwacr.filled>.input>.label[data-v-bcae1c0a],.eiipwacr.focused>.input>.label[data-v-bcae1c0a]{top:-17px;left:0!important;transform:scale(.75)}',""]),e.exports=i},39887:(e,t,a)=>{var i=a(23645)((function(e){return e[1]}));i.push([e.id,".romcojzs[data-v-ceef7994]{padding:0 16px 16px}",""]),e.exports=i},67380:(e,t,a)=>{var i=a(23645)((function(e){return e[1]}));i.push([e.id,".ilrvjyvi>.children[data-v-4140cbcc]{padding:16px}",""]),e.exports=i},81590:(e,t,a)=>{var i=a(23645)((function(e){return e[1]}));i.push([e.id,".gwbmwxkm[data-v-2488f796]{position:relative}.gwbmwxkm>header>.title[data-v-2488f796]{z-index:1;margin:0;padding:0 16px;line-height:42px;font-size:.9em;font-weight:700;box-shadow:0 1px rgba(0,0,0,.07)}.gwbmwxkm>header>.title>[data-icon][data-v-2488f796]{margin-right:6px}.gwbmwxkm>header>.title[data-v-2488f796]:empty{display:none}.gwbmwxkm>header>.buttons[data-v-2488f796]{position:absolute;z-index:2;top:0;right:0}.gwbmwxkm>header>.buttons>button[data-v-2488f796]{padding:0;width:42px;font-size:.9em;line-height:42px}.gwbmwxkm>section[data-v-2488f796]{padding:0 32px 32px}@media(max-width:500px){.gwbmwxkm>section[data-v-2488f796]{padding:0 16px 16px}}.gwbmwxkm>section>.view[data-v-2488f796]{display:inline-block;margin:16px 0 0;font-size:14px}.gwbmwxkm>section>.content[data-v-2488f796]{margin-bottom:16px}.gwbmwxkm>section>.eyeCatch[data-v-2488f796]{margin-bottom:16px}.gwbmwxkm>section>.eyeCatch>div>img[data-v-2488f796]{max-width:100%}.qmuvgica[data-v-2488f796]{padding:32px}@media(max-width:500px){.qmuvgica[data-v-2488f796]{padding:16px}}.qmuvgica>.variables[data-v-2488f796]{margin-bottom:16px}.qmuvgica>.add[data-v-2488f796]{margin-bottom:16px}",""]),e.exports=i},34581:(e,t,a)=>{"use strict";function i(e){const t=[],a=e=>{for(const i of e)"textInput"===i.type||"textareaInput"===i.type?t.push({name:i.name,type:"string",value:i.default||""}):"numberInput"===i.type?t.push({name:i.name,type:"number",value:i.default||0}):"switch"===i.type?t.push({name:i.name,type:"boolean",value:i.default||!1}):"counter"===i.type?t.push({name:i.name,type:"number",value:0}):"radioButton"===i.type?t.push({name:i.name,type:"string",value:i.default||""}):i.children&&a(i.children)};return a(e),t}a.d(t,{k:()=>i})},69146:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var i=a(55393);const n=(0,i.withScopeId)("data-v-1dbdaf33");(0,i.pushScopeId)("data-v-1dbdaf33");const o={key:0,ref:"header"},l={class:"title"},s={class:"sub"};(0,i.popScopeId)();const r=n(((e,t,a,r,c,d)=>{const p=(0,i.resolveComponent)("Fa"),u=(0,i.resolveDirective)("size");return(0,i.withDirectives)(((0,i.openBlock)(),(0,i.createBlock)("div",{class:["ukygtjoj _panel",{naked:e.naked,hideHeader:!e.showHeader,scrollable:e.scrollable,closed:!e.showBody}]},[e.showHeader?((0,i.openBlock)(),(0,i.createBlock)("header",o,[(0,i.createVNode)("div",l,[(0,i.renderSlot)(e.$slots,"header")]),(0,i.createVNode)("div",s,[(0,i.renderSlot)(e.$slots,"func"),e.bodyTogglable?((0,i.openBlock)(),(0,i.createBlock)("button",{key:0,class:"_button",onClick:t[1]||(t[1]=()=>e.showBody=!e.showBody)},[e.showBody?((0,i.openBlock)(),(0,i.createBlock)(p,{key:0,icon:e.faAngleUp},null,8,["icon"])):((0,i.openBlock)(),(0,i.createBlock)(p,{key:1,icon:e.faAngleDown},null,8,["icon"]))])):(0,i.createCommentVNode)("",!0)])],512)):(0,i.createCommentVNode)("",!0),(0,i.createVNode)(i.Transition,{name:"container-toggle",onEnter:e.enter,onAfterEnter:e.afterEnter,onLeave:e.leave,onAfterLeave:e.afterLeave},{default:n((()=>[(0,i.withDirectives)((0,i.createVNode)("div",null,[(0,i.renderSlot)(e.$slots,"default")],512),[[i.vShow,e.showBody]])])),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],2)),[[u,{max:[380]}]])}));var c=a(51436);const d=(0,i.defineComponent)({props:{showHeader:{type:Boolean,required:!1,default:!0},naked:{type:Boolean,required:!1,default:!1},bodyTogglable:{type:Boolean,required:!1,default:!1},expanded:{type:Boolean,required:!1,default:!0},scrollable:{type:Boolean,required:!1,default:!1}},data(){return{showBody:this.expanded,faAngleUp:c.onQ,faAngleDown:c.gc2}},mounted(){this.$watch("showBody",(e=>{const t=this.showHeader?this.$refs.header.offsetHeight:0;this.$el.style.minHeight=t+"px",this.$el.style.flexBasis=e?"auto":t+"px"}),{immediate:!0})},methods:{toggleContent(e){this.bodyTogglable&&(this.showBody=e)},enter(e){const t=e.getBoundingClientRect().height;e.style.height=0,e.offsetHeight,e.style.height=t+"px"},afterEnter(e){e.style.height=null},leave(e){const t=e.getBoundingClientRect().height;e.style.height=t+"px",e.offsetHeight,e.style.height=0},afterLeave(e){e.style.height=null}}});a(64935);d.render=r,d.__scopeId="data-v-1dbdaf33";const p=d},66018:(e,t,a)=>{"use strict";a.d(t,{Z:()=>h});var i=a(55393);const n=(0,i.withScopeId)("data-v-bcae1c0a");(0,i.pushScopeId)("data-v-bcae1c0a");const o={class:"icon",ref:"icon"},l={class:"label",ref:"label"},s={class:"prefix",ref:"prefix"},r={class:"suffix"},c={class:"text"};(0,i.popScopeId)();const d=n(((e,t,a,n,d,p)=>{const u=(0,i.resolveComponent)("Fa");return(0,i.openBlock)(),(0,i.createBlock)("div",{class:["eiipwacr",{focused:e.focused,disabled:e.disabled,filled:e.filled,inline:e.inline}]},[(0,i.createVNode)("div",o,[(0,i.renderSlot)(e.$slots,"icon")],512),(0,i.createVNode)("div",{class:"input",onClick:t[4]||(t[4]=(...t)=>e.focus&&e.focus(...t))},[(0,i.createVNode)("span",l,[(0,i.renderSlot)(e.$slots,"label")],512),(0,i.createVNode)("div",s,[(0,i.renderSlot)(e.$slots,"prefix")],512),(0,i.withDirectives)((0,i.createVNode)("select",{ref:"input","onUpdate:modelValue":t[1]||(t[1]=t=>e.v=t),required:e.required,disabled:e.disabled,onFocus:t[2]||(t[2]=t=>e.focused=!0),onBlur:t[3]||(t[3]=t=>e.focused=!1)},[(0,i.renderSlot)(e.$slots,"default")],40,["required","disabled"]),[[i.vModelSelect,e.v]]),(0,i.createVNode)("div",r,[(0,i.renderSlot)(e.$slots,"suffix",{},(()=>[(0,i.createVNode)(u,{icon:e.faChevronDown},null,8,["icon"])]))])]),(0,i.createVNode)("div",c,[(0,i.renderSlot)(e.$slots,"text")])],2)}));var p=a(51436);const u=(0,i.defineComponent)({props:{value:{required:!1},required:{type:Boolean,required:!1},disabled:{type:Boolean,required:!1},inline:{type:Boolean,required:!1,default:!1}},data:()=>({focused:!1,faChevronDown:p.ptq}),computed:{v:{get(){return this.value},set(e){this.$emit("update:value",e)}},filled:()=>!0},mounted(){this.$refs.prefix&&(this.$refs.label.style.left=this.$refs.prefix.offsetLeft+this.$refs.prefix.offsetWidth+"px")},methods:{focus(){this.$refs.input.focus()}}});a(33599);u.render=d,u.__scopeId="data-v-bcae1c0a";const h=u},13378:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var i=a(55393);const n=(0,i.withScopeId)("data-v-ceef7994");(0,i.pushScopeId)("data-v-ceef7994");const o={class:"romcojzs"};(0,i.popScopeId)();const l=n(((e,t,a,l,s,r)=>{const c=(0,i.resolveComponent)("Fa"),d=(0,i.resolveComponent)("MkSelect"),p=(0,i.resolveComponent)("XBlocks"),u=(0,i.resolveComponent)("XContainer");return(0,i.openBlock)(),(0,i.createBlock)(u,{onRemove:t[4]||(t[4]=()=>e.$emit("remove")),draggable:!0},{header:n((()=>[(0,i.createVNode)(c,{icon:e.faQuestion},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.blocks.if),1)])),func:n((()=>[(0,i.createVNode)("button",{onClick:t[1]||(t[1]=t=>e.add()),class:"_button"},[(0,i.createVNode)(c,{icon:e.faPlus},null,8,["icon"])])])),default:n((()=>[(0,i.createVNode)("section",o,[(0,i.createVNode)(d,{value:e.value.var,"onUpdate:value":t[2]||(t[2]=t=>e.value.var=t)},{label:n((()=>[(0,i.createTextVNode)((0,i.toDisplayString)(e.$ts._pages.blocks._if.variable),1)])),default:n((()=>[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.hpml.getVarsByType("boolean"),(e=>((0,i.openBlock)(),(0,i.createBlock)("option",{value:e.name},(0,i.toDisplayString)(e.name),9,["value"])))),256)),(0,i.createVNode)("optgroup",{label:e.$ts._pages.script.pageVariables},[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.hpml.getPageVarsByType("boolean"),(e=>((0,i.openBlock)(),(0,i.createBlock)("option",{value:e},(0,i.toDisplayString)(e),9,["value"])))),256))],8,["label"]),(0,i.createVNode)("optgroup",{label:e.$ts._pages.script.enviromentVariables},[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.hpml.getEnvVarsByType("boolean"),(e=>((0,i.openBlock)(),(0,i.createBlock)("option",{value:e},(0,i.toDisplayString)(e),9,["value"])))),256))],8,["label"])])),_:1},8,["value"]),(0,i.createVNode)(p,{class:"children",value:e.value.children,"onUpdate:value":t[3]||(t[3]=t=>e.value.children=t),hpml:e.hpml},null,8,["value","hpml"])])])),_:1})}));var s=a(44586),r=a(51436),c=a(1223),d=a(66018),p=a(10192);const u=(0,i.defineComponent)({components:{XContainer:c.default,MkSelect:d.Z,XBlocks:(0,i.defineAsyncComponent)((()=>Promise.all([a.e(5567),a.e(1473),a.e(893),a.e(156)]).then(a.bind(a,893))))},inject:["getPageBlockList"],props:{value:{required:!0},hpml:{required:!0}},data:()=>({faPlus:r.r8p,faQuestion:r.Psp}),created(){null==this.value.children&&(this.value.children=[]),void 0===this.value.var&&(this.value.var=null)},methods:{async add(){const{canceled:e,result:t}=await p.WZ({type:null,title:this.$ts._pages.chooseBlock,select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,s.Z)();this.value.children.push({id:a,type:t})}}});a(11096);u.render=l,u.__scopeId="data-v-ceef7994";const h=u},28423:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var i=a(55393);const n=(0,i.withScopeId)("data-v-4140cbcc");(0,i.pushScopeId)("data-v-4140cbcc");const o={class:"ilrvjyvi"};(0,i.popScopeId)();const l=n(((e,t,a,l,s,r)=>{const c=(0,i.resolveComponent)("Fa"),d=(0,i.resolveComponent)("XBlocks"),p=(0,i.resolveComponent)("XContainer");return(0,i.openBlock)(),(0,i.createBlock)(p,{onRemove:t[4]||(t[4]=()=>e.$emit("remove")),draggable:!0},{header:n((()=>[(0,i.createVNode)(c,{icon:e.faStickyNote},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.value.title),1)])),func:n((()=>[(0,i.createVNode)("button",{onClick:t[1]||(t[1]=t=>e.rename()),class:"_button"},[(0,i.createVNode)(c,{icon:e.faPencilAlt},null,8,["icon"])]),(0,i.createVNode)("button",{onClick:t[2]||(t[2]=t=>e.add()),class:"_button"},[(0,i.createVNode)(c,{icon:e.faPlus},null,8,["icon"])])])),default:n((()=>[(0,i.createVNode)("section",o,[(0,i.createVNode)(d,{class:"children",value:e.value.children,"onUpdate:value":t[3]||(t[3]=t=>e.value.children=t),hpml:e.hpml},null,8,["value","hpml"])])])),_:1})}));var s=a(44586),r=a(51436),c=a(56024),d=a(1223),p=a(10192);const u=(0,i.defineComponent)({components:{XContainer:d.default,XBlocks:(0,i.defineAsyncComponent)((()=>Promise.all([a.e(5567),a.e(1473),a.e(893),a.e(5485)]).then(a.bind(a,893))))},inject:["getPageBlockList"],props:{value:{required:!0},hpml:{required:!0}},data:()=>({faStickyNote:c.L4,faPlus:r.r8p,faPencilAlt:r.UJf}),created(){null==this.value.title&&(this.value.title=null),null==this.value.children&&(this.value.children=[])},mounted(){null==this.value.title&&this.rename()},methods:{async rename(){const{canceled:e,result:t}=await p.WZ({title:"Enter title",input:{type:"text",default:this.value.title},showCancelButton:!0});e||(this.value.title=t)},async add(){const{canceled:e,result:t}=await p.WZ({type:null,title:this.$ts._pages.chooseBlock,select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,s.Z)();this.value.children.push({id:a,type:t})}}});a(56039);u.render=l,u.__scopeId="data-v-4140cbcc";const h=u},44367:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>M});var i=a(55393);const n=(0,i.withScopeId)("data-v-2488f796");(0,i.pushScopeId)("data-v-2488f796");const o={class:"_section"},l={class:"_content"},s={class:"buttons",style:{margin:"16px 0"}},r={class:"_section"},c={value:"serif"},d={value:"sans-serif"},p={class:"eyeCatch"},u={key:1},h={class:"_section"},g={class:"qmuvgica"};(0,i.popScopeId)();const v=n(((e,t,a,v,f,m)=>{const y=(0,i.resolveComponent)("Fa"),b=(0,i.resolveComponent)("MkA"),x=(0,i.resolveComponent)("MkButton"),k=(0,i.resolveComponent)("MkInput"),w=(0,i.resolveComponent)("MkSwitch"),V=(0,i.resolveComponent)("MkSelect"),N=(0,i.resolveComponent)("MkContainer"),C=(0,i.resolveComponent)("XBlocks"),_=(0,i.resolveComponent)("XVariable"),B=(0,i.resolveComponent)("XDraggable"),I=(0,i.resolveComponent)("MkTextarea");return(0,i.openBlock)(),(0,i.createBlock)("div",o,[(0,i.createVNode)("div",l,[e.pageId?((0,i.openBlock)(),(0,i.createBlock)(b,{key:0,class:"view",to:`/@${e.author.username}/pages/${e.currentName}`},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faExternalLinkSquareAlt},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.viewPage),1)])),_:1},8,["to"])):(0,i.createCommentVNode)("",!0),(0,i.createVNode)("div",s,[(0,i.createVNode)(x,{inline:"",onClick:e.save,primary:"",class:"save"},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faSave},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts.save),1)])),_:1},8,["onClick"]),e.pageId?((0,i.openBlock)(),(0,i.createBlock)(x,{key:0,inline:"",onClick:e.duplicate,class:"duplicate"},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faCopy},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts.duplicate),1)])),_:1},8,["onClick"])):(0,i.createCommentVNode)("",!0),e.pageId?((0,i.openBlock)(),(0,i.createBlock)(x,{key:1,inline:"",onClick:e.del,class:"delete"},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faTrashAlt},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts.delete),1)])),_:1},8,["onClick"])):(0,i.createCommentVNode)("",!0)]),(0,i.createVNode)(N,{"body-togglable":!0,expanded:!0,class:"_vMargin"},{header:n((()=>[(0,i.createVNode)(y,{icon:e.faCog},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.pageSetting),1)])),default:n((()=>[(0,i.createVNode)("div",r,[(0,i.createVNode)(k,{value:e.title,"onUpdate:value":t[1]||(t[1]=t=>e.title=t)},{default:n((()=>[(0,i.createVNode)("span",null,(0,i.toDisplayString)(e.$ts._pages.title),1)])),_:1},8,["value"]),(0,i.createVNode)(k,{value:e.summary,"onUpdate:value":t[2]||(t[2]=t=>e.summary=t)},{default:n((()=>[(0,i.createVNode)("span",null,(0,i.toDisplayString)(e.$ts._pages.summary),1)])),_:1},8,["value"]),(0,i.createVNode)(k,{value:e.name,"onUpdate:value":t[3]||(t[3]=t=>e.name=t)},{prefix:n((()=>[(0,i.createTextVNode)((0,i.toDisplayString)(e.url)+"/@"+(0,i.toDisplayString)(e.author.username)+"/pages/",1)])),default:n((()=>[(0,i.createVNode)("span",null,(0,i.toDisplayString)(e.$ts._pages.url),1)])),_:1},8,["value"]),(0,i.createVNode)(w,{value:e.alignCenter,"onUpdate:value":t[4]||(t[4]=t=>e.alignCenter=t)},{default:n((()=>[(0,i.createTextVNode)((0,i.toDisplayString)(e.$ts._pages.alignCenter),1)])),_:1},8,["value"]),(0,i.createVNode)(V,{value:e.font,"onUpdate:value":t[5]||(t[5]=t=>e.font=t)},{label:n((()=>[(0,i.createTextVNode)((0,i.toDisplayString)(e.$ts._pages.font),1)])),default:n((()=>[(0,i.createVNode)("option",c,(0,i.toDisplayString)(e.$ts._pages.fontSerif),1),(0,i.createVNode)("option",d,(0,i.toDisplayString)(e.$ts._pages.fontSansSerif),1)])),_:1},8,["value"]),(0,i.createVNode)(w,{value:e.hideTitleWhenPinned,"onUpdate:value":t[6]||(t[6]=t=>e.hideTitleWhenPinned=t)},{default:n((()=>[(0,i.createTextVNode)((0,i.toDisplayString)(e.$ts._pages.hideTitleWhenPinned),1)])),_:1},8,["value"]),(0,i.createVNode)("div",p,[null!=e.eyeCatchingImageId||e.readonly?e.eyeCatchingImage?((0,i.openBlock)(),(0,i.createBlock)("div",u,[(0,i.createVNode)("img",{src:e.eyeCatchingImage.url,alt:e.eyeCatchingImage.name,style:{"max-width":"100%"}},null,8,["src","alt"]),e.readonly?(0,i.createCommentVNode)("",!0):((0,i.openBlock)(),(0,i.createBlock)(x,{key:0,onClick:t[7]||(t[7]=t=>e.removeEyeCatchingImage())},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faTrashAlt},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.eyeCatchingImageRemove),1)])),_:1}))])):(0,i.createCommentVNode)("",!0):((0,i.openBlock)(),(0,i.createBlock)(x,{key:0,onClick:e.setEyeCatchingImage},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faPlus},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.eyeCatchingImageSet),1)])),_:1},8,["onClick"]))])])])),_:1}),(0,i.createVNode)(N,{"body-togglable":!0,expanded:!0,class:"_vMargin"},{header:n((()=>[(0,i.createVNode)(y,{icon:e.faStickyNote},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.contents),1)])),default:n((()=>[(0,i.createVNode)("div",h,[(0,i.createVNode)(C,{class:"content",value:e.content,"onUpdate:value":t[8]||(t[8]=t=>e.content=t),hpml:e.hpml},null,8,["value","hpml"]),e.readonly?(0,i.createCommentVNode)("",!0):((0,i.openBlock)(),(0,i.createBlock)(x,{key:0,onClick:t[9]||(t[9]=t=>e.add())},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faPlus},null,8,["icon"])])),_:1}))])])),_:1}),(0,i.createVNode)(N,{"body-togglable":!0,class:"_vMargin"},{header:n((()=>[(0,i.createVNode)(y,{icon:e.faMagic},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts._pages.variables),1)])),default:n((()=>[(0,i.createVNode)("div",g,[(0,i.withDirectives)((0,i.createVNode)(B,{tag:"div",class:"variables",modelValue:e.variables,"onUpdate:modelValue":t[10]||(t[10]=t=>e.variables=t),"item-key":"name",handle:".drag-handle",group:{name:"variables"},animation:"150","swap-threshold":"0.5"},{item:n((({element:t})=>[(0,i.createVNode)(_,{value:t,removable:!0,onRemove:()=>e.removeVariable(t),hpml:e.hpml,name:t.name,title:t.name,draggable:!0},null,8,["value","onRemove","hpml","name","title"])])),_:1},8,["modelValue"]),[[i.vShow,e.variables.length>0]]),e.readonly?(0,i.createCommentVNode)("",!0):((0,i.openBlock)(),(0,i.createBlock)(x,{key:0,onClick:t[11]||(t[11]=t=>e.addVariable()),class:"add"},{default:n((()=>[(0,i.createVNode)(y,{icon:e.faPlus},null,8,["icon"])])),_:1}))])])),_:1}),(0,i.createVNode)(N,{"body-togglable":!0,expanded:!0,class:"_vMargin"},{header:n((()=>[(0,i.createVNode)(y,{icon:e.faCode},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts.script),1)])),default:n((()=>[(0,i.createVNode)("div",null,[(0,i.createVNode)(I,{class:"_code",value:e.script,"onUpdate:value":t[12]||(t[12]=t=>e.script=t)},null,8,["value"])])])),_:1})])])}));a(15660);var f=a(28325),m=(a(35433),a(39980),a(80194),a(88252),a(51436)),y=a(56024),b=a(44586),x=a(35440),k=a(893),w=a(19055),V=a(69146),N=a(42453),C=a(66018),_=a(83359),B=a(77121),I=a(32443),$=a(88572),S=a(36633),T=a(60662),j=function(e,t,a,i){var n,o=arguments.length,l=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(l=(o<3?n(l):o>3?n(t,a,l):n(t,a))||l);return o>3&&l&&Object.defineProperty(t,a,l),l};class P{constructor(e=[],t=[]){this.variables=e,this.pageVars=t}typeCheck(e){if((0,S.$)(e))return null;const t=T.iN[e.type||""];if(null==t)throw new Error("Unknown type: "+e.type);const a=[];for(let i=0;i<t.in.length;i++){const n=t.in[i],o=this.infer(e.args[i]);if(null!==o)if("number"==typeof n){if(void 0===a[n])a[n]=o;else if(o!==a[n])return{arg:i,expect:a[n],actual:o}}else if(o!==n)return{arg:i,expect:n,actual:o}}return null}getExpectedType(e,t){const a=T.iN[e.type||""];if(null==a)throw new Error("Unknown type: "+e.type);const i=[];for(let t=0;t<a.in.length;t++){const n=a.in[t],o=this.infer(e.args[t]);null!==o&&("number"==typeof n&&void 0===i[n]&&(i[n]=o))}return"number"==typeof a.in[t]?i[a.in[t]]||null:a.in[t]}infer(e){if(null===e.type)return null;if("text"===e.type)return"string";if("multiLineText"===e.type)return"string";if("textList"===e.type)return"stringArray";if("number"===e.type)return"number";if("ref"===e.type){const t=this.variables.find((t=>t.name===e.value));if(t)return this.infer(t);const a=this.pageVars.find((t=>t.name===e.value));if(a)return a.type;const i=I.Mo[e.value||""];return void 0!==i?i:null}if("aiScriptVar"===e.type)return null;if("fn"===e.type)return null;if(e.type.startsWith("fn:"))return null;const t=[],a=T.iN[e.type];for(let i=0;i<a.in.length;i++){const n=a.in[i];if("number"==typeof n){const a=this.infer(e.args[i]);void 0===t[n]?t[n]=a:a!==t[n]&&(t[n]=null)}}return"number"==typeof a.out?t[a.out]:a.out}getVarByName(e){const t=this.variables.find((t=>t.name===e));if(void 0!==t)return t;throw new Error(`No such variable '${e}'`)}getVarsByType(e){return null==e?this.variables:this.variables.filter((t=>null===this.infer(t)||this.infer(t)===e))}getEnvVarsByType(e){return null==e?Object.keys(I.Mo):Object.entries(I.Mo).filter((([t,a])=>null===a||e===a)).map((([e,t])=>e))}getPageVarsByType(e){return null==e?this.pageVars.map((e=>e.name)):this.pageVars.filter((t=>e===t.type)).map((e=>e.name))}isUsedName(e){return!!this.variables.some((t=>t.name===e))||(!!this.pageVars.some((t=>t.name===e))||!!I.Mo[e])}}j([$.default],P.prototype,"typeCheck",null),j([$.default],P.prototype,"getExpectedType",null),j([$.default],P.prototype,"infer",null),j([$.default],P.prototype,"getVarByName",null),j([$.default],P.prototype,"getVarsByType",null),j([$.default],P.prototype,"getEnvVarsByType",null),j([$.default],P.prototype,"getPageVarsByType",null),j([$.default],P.prototype,"isUsedName",null);var D=a(34862),Z=a(34581),L=a(10192),q=a(14975);const A=(0,i.defineComponent)({components:{XDraggable:(0,i.defineAsyncComponent)((()=>a.e(9980).then(a.t.bind(a,82021,23)).then((e=>e.default)))),XVariable:x.default,XBlocks:k.default,MkTextarea:w.Z,MkContainer:V.Z,MkButton:N.Z,MkSelect:C.Z,MkSwitch:_.Z,MkInput:B.Z},props:{initPageId:{type:String,required:!1},initPageName:{type:String,required:!1},initUser:{type:String,required:!1}},data(){return{INFO:(0,i.computed)((()=>this.initPageId?{title:this.$ts._pages.editPage,icon:m.UJf}:{title:this.$ts._pages.newPage,icon:m.UJf})),author:this.$i,readonly:!1,page:null,pageId:null,currentName:null,title:"",summary:null,name:Date.now().toString(),eyeCatchingImage:null,eyeCatchingImageId:null,font:"sans-serif",content:[],alignCenter:!1,hideTitleWhenPinned:!1,variables:[],hpml:null,script:"",url:D.HQ,faPlus:m.r8p,faICursor:m.sdN,faSave:y.r6,faStickyNote:y.L4,faMagic:m.een,faCog:m.b7W,faTrashAlt:y.I7,faExternalLinkSquareAlt:m.cyx,faCode:m.dT$,faCopy:m.kZ_}},watch:{async eyeCatchingImageId(){null==this.eyeCatchingImageId?this.eyeCatchingImage=null:this.eyeCatchingImage=await L.hi("drive/files/show",{fileId:this.eyeCatchingImageId})}},async created(){if(this.hpml=new P,this.$watch("variables",(()=>{this.hpml.variables=this.variables}),{deep:!0}),this.$watch("content",(()=>{this.hpml.pageVars=(0,Z.k)(this.content)}),{deep:!0}),this.initPageId?this.page=await L.hi("pages/show",{pageId:this.initPageId}):this.initPageName&&this.initUser&&(this.page=await L.hi("pages/show",{name:this.initPageName,username:this.initUser}),this.readonly=!0),this.page)this.author=this.page.user,this.pageId=this.page.id,this.title=this.page.title,this.name=this.page.name,this.currentName=this.page.name,this.summary=this.page.summary,this.font=this.page.font,this.script=this.page.script,this.hideTitleWhenPinned=this.page.hideTitleWhenPinned,this.alignCenter=this.page.alignCenter,this.content=this.page.content,this.variables=this.page.variables,this.eyeCatchingImageId=this.page.eyeCatchingImageId;else{const e=(0,b.Z)();this.content=[{id:e,type:"text",text:"Hello World!"}]}},provide(){return{readonly:this.readonly,getScriptBlockList:this.getScriptBlockList,getPageBlockList:this.getPageBlockList}},methods:{getSaveOptions(){return{title:this.title.trim(),name:this.name.trim(),summary:this.summary,font:this.font,script:this.script,hideTitleWhenPinned:this.hideTitleWhenPinned,alignCenter:this.alignCenter,content:this.content,variables:this.variables,eyeCatchingImageId:this.eyeCatchingImageId}},save(){const e=this.getSaveOptions(),t=e=>{"3d81ceae-475f-4600-b2a8-2bc116157532"==e.id?"name"==e.info.param&&L.WZ({type:"error",title:this.$ts._pages.invalidNameTitle,text:this.$ts._pages.invalidNameText}):"NAME_ALREADY_EXISTS"==e.code&&L.WZ({type:"error",text:this.$ts._pages.nameAlreadyExists})};this.pageId?(e.pageId=this.pageId,L.hi("pages/update",e).then((e=>{this.currentName=this.name.trim(),L.WZ({type:"success",text:this.$ts._pages.updated})})).catch(t)):L.hi("pages/create",e).then((e=>{this.pageId=e.id,this.currentName=this.name.trim(),L.WZ({type:"success",text:this.$ts._pages.created}),this.$router.push("/pages/edit/"+this.pageId)})).catch(t)},del(){L.WZ({type:"warning",text:this.$t("removeAreYouSure",{x:this.title.trim()}),showCancelButton:!0}).then((({canceled:e})=>{e||L.hi("pages/delete",{pageId:this.pageId}).then((()=>{L.WZ({type:"success",text:this.$ts._pages.deleted}),this.$router.push("/pages")}))}))},duplicate(){this.title=this.title+" - copy",this.name=this.name+"-copy",L.hi("pages/create",this.getSaveOptions()).then((e=>{this.pageId=e.id,this.currentName=this.name.trim(),L.WZ({type:"success",text:this.$ts._pages.created}),this.$router.push("/pages/edit/"+this.pageId)}))},async add(){const{canceled:e,result:t}=await L.WZ({type:null,title:this.$ts._pages.chooseBlock,select:{groupedItems:this.getPageBlockList()},showCancelButton:!0});if(e)return;const a=(0,b.Z)();this.content.push({id:a,type:t})},async addVariable(){let{canceled:e,result:t}=await L.WZ({title:this.$ts._pages.enterVariableName,input:{type:"text"},showCancelButton:!0});if(e)return;if(t=t.trim(),this.hpml.isUsedName(t))return void L.WZ({type:"error",text:this.$ts._pages.variableNameIsAlreadyUsed});const a=(0,b.Z)();this.variables.push({id:a,name:t,type:null})},removeVariable(e){this.variables=this.variables.filter((t=>t.name!==e.name))},getPageBlockList(){return[{label:this.$ts._pages.contentBlocks,items:[{value:"section",text:this.$ts._pages.blocks.section},{value:"text",text:this.$ts._pages.blocks.text},{value:"image",text:this.$ts._pages.blocks.image},{value:"textarea",text:this.$ts._pages.blocks.textarea},{value:"note",text:this.$ts._pages.blocks.note},{value:"canvas",text:this.$ts._pages.blocks.canvas}]},{label:this.$ts._pages.inputBlocks,items:[{value:"button",text:this.$ts._pages.blocks.button},{value:"radioButton",text:this.$ts._pages.blocks.radioButton},{value:"textInput",text:this.$ts._pages.blocks.textInput},{value:"textareaInput",text:this.$ts._pages.blocks.textareaInput},{value:"numberInput",text:this.$ts._pages.blocks.numberInput},{value:"switch",text:this.$ts._pages.blocks.switch},{value:"counter",text:this.$ts._pages.blocks.counter}]},{label:this.$ts._pages.specialBlocks,items:[{value:"if",text:this.$ts._pages.blocks.if},{value:"post",text:this.$ts._pages.blocks.post}]}]},getScriptBlockList(e=null){const t=[],a=I.uA.filter((t=>null===e||null===t.out||t.out===e||"number"==typeof t.out));for(const e of a){const a=t.find((t=>t.category===e.category));a?a.items.push({value:e.type,text:this.$t("_pages.script.blocks."+e.type)}):t.push({category:e.category,label:this.$t("_pages.script.categories."+e.category),items:[{value:e.type,text:this.$t("_pages.script.blocks."+e.type)}]})}const i=this.variables.filter((e=>"fn"===e.type));return i.length>0&&t.unshift({label:this.$t("_pages.script.categories.fn"),items:i.map((e=>({value:"fn:"+e.name,text:e.name})))}),t},setEyeCatchingImage(e){(0,q.$)(e.currentTarget||e.target,null,!1).then((e=>{this.eyeCatchingImageId=e.id}))},removeEyeCatchingImage(){this.eyeCatchingImageId=null},highlighter:e=>(0,f.highlight)(e,f.languages.js,"javascript")}});a(70431);A.render=v,A.__scopeId="data-v-2488f796";const M=A},64935:(e,t,a)=>{var i=a(62960);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(45346).Z)("ab0d80cc",i,!0,{})},33599:(e,t,a)=>{var i=a(26051);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(45346).Z)("03940eb0",i,!0,{})},11096:(e,t,a)=>{var i=a(39887);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(45346).Z)("a54be4f6",i,!0,{})},56039:(e,t,a)=>{var i=a(67380);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(45346).Z)("05442b6e",i,!0,{})},70431:(e,t,a)=>{var i=a(81590);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(45346).Z)("8ef14dea",i,!0,{})}}]);