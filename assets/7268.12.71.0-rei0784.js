(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[7268],{26743:(e,i,t)=>{var a=t(23645)((function(e){return e[1]}));a.push([e.id,"@keyframes warnBlink-0a3b6b63{0%{opacity:1}50%{opacity:0}}.mkw-jobQueue[data-v-0a3b6b63]{font-size:.9em}.mkw-jobQueue>div[data-v-0a3b6b63]{padding:16px}.mkw-jobQueue>div[data-v-0a3b6b63]:not(:first-child){border-top:1px solid var(--divider)}.mkw-jobQueue>div>.label[data-v-0a3b6b63]{display:flex}.mkw-jobQueue>div>.label>.icon[data-v-0a3b6b63]{color:var(--warn);margin-left:auto;animation:warnBlink-0a3b6b63 1s infinite}.mkw-jobQueue>div>.values[data-v-0a3b6b63]{display:flex}.mkw-jobQueue>div>.values>div[data-v-0a3b6b63]{flex:1}.mkw-jobQueue>div>.values>div>div[data-v-0a3b6b63]:first-child{opacity:.7}.mkw-jobQueue>div>.values>div>div:last-child.inc[data-v-0a3b6b63]{color:var(--warn)}.mkw-jobQueue>div>.values>div>div:last-child.dec[data-v-0a3b6b63]{color:var(--success)}",""]),e.exports=a},46397:(e,i,t)=>{"use strict";t.d(i,{Z:()=>c});var a=t(55393),n=t(51084),o=t(10192);function c(e){return(0,a.defineComponent)({props:{widget:{type:Object,required:!1},settingCallback:{required:!1}},emits:["updateProps"],data(){return{props:this.widget?JSON.parse(JSON.stringify(this.widget.data)):{},save:(0,n.P)(3e3,(()=>{this.$emit("updateProps",this.props)}))}},computed:{id(){return this.widget?this.widget.id:null}},created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()}),{deep:!0}),this.settingCallback&&this.settingCallback(this.setting)},methods:{mergeProps(){if(e.props){const i=e.props();for(const e of Object.keys(i))this.props.hasOwnProperty(e)||(this.props[e]=i[e].default)}},async setting(){const i=e.props();for(const e of Object.keys(i))i[e].default=this.props[e];const{canceled:t,result:a}=await o.cr(e.name,i);if(!t){for(const e of Object.keys(a))this.props[e]=a[e];this.save()}}}})}},7268:(e,i,t)=>{"use strict";t.r(i),t.d(i,{default:()=>j});var a=t(55393);const n=(0,a.withScopeId)("data-v-0a3b6b63");(0,a.pushScopeId)("data-v-0a3b6b63");const o={class:"inbox"},c={class:"label"},r=(0,a.createTextVNode)("Inbox queue"),d={class:"values"},s=(0,a.createVNode)("div",null,"Process",-1),l=(0,a.createVNode)("div",null,"Active",-1),v=(0,a.createVNode)("div",null,"Delayed",-1),p=(0,a.createVNode)("div",null,"Waiting",-1),b={class:"deliver"},u={class:"label"},g=(0,a.createTextVNode)("Deliver queue"),h={class:"values"},m=(0,a.createVNode)("div",null,"Process",-1),k=(0,a.createVNode)("div",null,"Active",-1),f=(0,a.createVNode)("div",null,"Delayed",-1),y=(0,a.createVNode)("div",null,"Waiting",-1);(0,a.popScopeId)();const w=n(((e,i,t,n,w,S)=>{const x=(0,a.resolveComponent)("Fa");return(0,a.openBlock)(),(0,a.createBlock)("div",{class:["mkw-jobQueue _monospace",{_panel:!e.props.transparent}]},[(0,a.createVNode)("div",o,[(0,a.createVNode)("div",c,[r,e.inbox.waiting>0?((0,a.openBlock)(),(0,a.createBlock)(x,{key:0,icon:e.faExclamationTriangle,class:"icon"},null,8,["icon"])):(0,a.createCommentVNode)("",!0)]),(0,a.createVNode)("div",d,[(0,a.createVNode)("div",null,[s,(0,a.createVNode)("div",{class:{inc:e.inbox.activeSincePrevTick>e.prev.inbox.activeSincePrevTick,dec:e.inbox.activeSincePrevTick<e.prev.inbox.activeSincePrevTick}},(0,a.toDisplayString)(e.number(e.inbox.activeSincePrevTick)),3)]),(0,a.createVNode)("div",null,[l,(0,a.createVNode)("div",{class:{inc:e.inbox.active>e.prev.inbox.active,dec:e.inbox.active<e.prev.inbox.active}},(0,a.toDisplayString)(e.number(e.inbox.active)),3)]),(0,a.createVNode)("div",null,[v,(0,a.createVNode)("div",{class:{inc:e.inbox.delayed>e.prev.inbox.delayed,dec:e.inbox.delayed<e.prev.inbox.delayed}},(0,a.toDisplayString)(e.number(e.inbox.delayed)),3)]),(0,a.createVNode)("div",null,[p,(0,a.createVNode)("div",{class:{inc:e.inbox.waiting>e.prev.inbox.waiting,dec:e.inbox.waiting<e.prev.inbox.waiting}},(0,a.toDisplayString)(e.number(e.inbox.waiting)),3)])])]),(0,a.createVNode)("div",b,[(0,a.createVNode)("div",u,[g,e.inbox.waiting>0?((0,a.openBlock)(),(0,a.createBlock)(x,{key:0,icon:e.faExclamationTriangle,class:"icon"},null,8,["icon"])):(0,a.createCommentVNode)("",!0)]),(0,a.createVNode)("div",h,[(0,a.createVNode)("div",null,[m,(0,a.createVNode)("div",{class:{inc:e.deliver.activeSincePrevTick>e.prev.deliver.activeSincePrevTick,dec:e.deliver.activeSincePrevTick<e.prev.deliver.activeSincePrevTick}},(0,a.toDisplayString)(e.number(e.deliver.activeSincePrevTick)),3)]),(0,a.createVNode)("div",null,[k,(0,a.createVNode)("div",{class:{inc:e.deliver.active>e.prev.deliver.active,dec:e.deliver.active<e.prev.deliver.active}},(0,a.toDisplayString)(e.number(e.deliver.active)),3)]),(0,a.createVNode)("div",null,[f,(0,a.createVNode)("div",{class:{inc:e.deliver.delayed>e.prev.deliver.delayed,dec:e.deliver.delayed<e.prev.deliver.delayed}},(0,a.toDisplayString)(e.number(e.deliver.delayed)),3)]),(0,a.createVNode)("div",null,[y,(0,a.createVNode)("div",{class:{inc:e.deliver.waiting>e.prev.deliver.waiting,dec:e.deliver.waiting<e.prev.deliver.waiting}},(0,a.toDisplayString)(e.number(e.deliver.waiting)),3)])])])],2)}));var S=t(51436),x=t(46397),N=t(10192),V=t(92906);const P=(0,x.Z)({name:"jobQueue",props:()=>({transparent:{type:"boolean",default:!1}})}),T=(0,a.defineComponent)({extends:P,data:()=>({connection:N.Vw.useSharedConnection("queueStats"),inbox:{activeSincePrevTick:0,active:0,waiting:0,delayed:0},deliver:{activeSincePrevTick:0,active:0,waiting:0,delayed:0},prev:{},faExclamationTriangle:S.eHv}),created(){for(const e of["inbox","deliver"])this.prev[e]=JSON.parse(JSON.stringify(this[e]));this.connection.on("stats",this.onStats),this.connection.on("statsLog",this.onStatsLog),this.connection.send("requestLog",{id:Math.random().toString().substr(2,8),length:1})},beforeUnmount(){this.connection.off("stats",this.onStats),this.connection.off("statsLog",this.onStatsLog),this.connection.dispose()},methods:{onStats(e){for(const i of["inbox","deliver"])this.prev[i]=JSON.parse(JSON.stringify(this[i])),this[i].activeSincePrevTick=e[i].activeSincePrevTick,this[i].active=e[i].active,this[i].waiting=e[i].waiting,this[i].delayed=e[i].delayed},onStatsLog(e){for(const i of[...e].reverse())this.onStats(i)},number:V.Z}});t(39416);T.render=w,T.__scopeId="data-v-0a3b6b63";const j=T},39416:(e,i,t)=>{var a=t(26743);"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,t(45346).Z)("0b4dc264",a,!0,{})}}]);