(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[9059],{17256:(e,t,o)=>{var i=o(23645)((function(e){return e[1]}));i.push([e.id,".omfetrab[data-v-1538924a]{--eachSize:40px;display:flex;flex-direction:column;contain:content}.omfetrab.big[data-v-1538924a]{--eachSize:44px}.omfetrab.w1[data-v-1538924a]{width:calc(var(--eachSize)*5 + 16px)}.omfetrab.w2[data-v-1538924a]{width:calc(var(--eachSize)*6 + 16px)}.omfetrab.w3[data-v-1538924a]{width:calc(var(--eachSize)*7 + 16px)}.omfetrab.h1[data-v-1538924a]{--height:calc(var(--eachSize)*4 + 16px)}.omfetrab.h2[data-v-1538924a]{--height:calc(var(--eachSize)*6 + 16px)}.omfetrab.h3[data-v-1538924a]{--height:calc(var(--eachSize)*8 + 16px)}.omfetrab>.search[data-v-1538924a]{width:100%;padding:12px;box-sizing:border-box;font-size:1em;outline:none;border:none;background:transparent;color:var(--fg)}.omfetrab>.search[data-v-1538924a]:not(.filled){order:1;z-index:2;box-shadow:0 -1px 0 0 var(--divider)}.omfetrab>.emojis[data-v-1538924a]{height:var(--height);overflow-y:auto;overflow-x:hidden;scrollbar-width:none}.omfetrab>.emojis[data-v-1538924a]::-webkit-scrollbar{display:none}.omfetrab>.emojis>.index[data-v-1538924a]{min-height:var(--height);position:relative;border-bottom:1px solid var(--divider)}.omfetrab>.emojis>.index>.arrow[data-v-1538924a]{position:absolute;bottom:0;left:0;width:100%;padding:16px 0;text-align:center;opacity:.5;pointer-events:none}.omfetrab>.emojis section>header[data-v-1538924a]{position:sticky;top:0;left:0;z-index:1;padding:8px;font-size:12px}.omfetrab>.emojis section>div[data-v-1538924a]{padding:8px}.omfetrab>.emojis section>div>button[data-v-1538924a]{position:relative;padding:0;width:var(--eachSize);height:var(--eachSize);border-radius:4px}.omfetrab>.emojis section>div>button[data-v-1538924a]:focus{outline:solid 2px var(--focus);z-index:1}.omfetrab>.emojis section>div>button[data-v-1538924a]:hover{background:rgba(0,0,0,.05)}.omfetrab>.emojis section>div>button[data-v-1538924a]:active{background:var(--accent);box-shadow:inset 0 .15em .3em rgba(27,31,35,.15)}.omfetrab>.emojis section>div>button>*[data-v-1538924a]{font-size:24px;height:1.25em;vertical-align:-.25em;pointer-events:none}.omfetrab>.emojis section.result[data-v-1538924a]{border-bottom:1px solid var(--divider)}.omfetrab>.emojis section.result[data-v-1538924a]:empty{display:none}.omfetrab>.emojis section.unicode[data-v-1538924a]{min-height:384px}.omfetrab>.emojis section.custom[data-v-1538924a]{min-height:64px}",""]),e.exports=i},9059:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>N});var i=o(55393);const a=(0,i.withScopeId)("data-v-1538924a");(0,i.pushScopeId)("data-v-1538924a");const s={class:"emojis",ref:"emojis"},n={class:"result"},c={key:0},r={key:1},l={class:"index"},d={key:0},m={class:"_acrylic"},h={class:"arrow"},u={key:0},f={class:"_acrylic"},p={key:0};(0,i.popScopeId)();const k=a(((e,t,o,k,v,b)=>{const g=(0,i.resolveComponent)("MkEmoji"),y=(0,i.resolveComponent)("Fa"),B=(0,i.resolveComponent)("MkModal"),x=(0,i.resolveDirective)("appear");return(0,i.openBlock)(),(0,i.createBlock)(B,{ref:"modal",src:e.src,onClick:t[4]||(t[4]=t=>e.$refs.modal.close()),onClosed:t[5]||(t[5]=t=>e.$emit("closed"))},{default:a((()=>[(0,i.createVNode)("div",{class:["omfetrab _popup",["w"+e.width,"h"+e.height,{big:e.big}]]},[(0,i.withDirectives)((0,i.createVNode)("input",{ref:"search",class:["search",{filled:null!=e.q&&""!=e.q}],"onUpdate:modelValue":t[1]||(t[1]=t=>e.q=t),placeholder:e.$ts.search,onPaste:t[2]||(t[2]=(0,i.withModifiers)(((...t)=>e.paste&&e.paste(...t)),["stop"])),onKeyup:t[3]||(t[3]=(0,i.withKeys)((t=>e.done()),["enter"]))},null,42,["placeholder"]),[[i.vModelText,e.q,void 0,{trim:!0}]]),(0,i.createVNode)("div",s,[(0,i.createVNode)("section",n,[e.searchResultCustom.length>0?((0,i.openBlock)(),(0,i.createBlock)("div",c,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.searchResultCustom,(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",title:t.name,onClick:o=>e.chosen(t,o),key:t,tabindex:"0"},[null!=t.char?((0,i.openBlock)(),(0,i.createBlock)(g,{key:0,emoji:t.char},null,8,["emoji"])):((0,i.openBlock)(),(0,i.createBlock)("img",{key:1,src:e.$store.state.disableShowingAnimatedImages?e.getStaticImageUrl(t.url):t.url},null,8,["src"]))],8,["title","onClick"])))),128))])):(0,i.createCommentVNode)("",!0),e.searchResultUnicode.length>0?((0,i.openBlock)(),(0,i.createBlock)("div",r,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.searchResultUnicode,(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",title:t.name,onClick:o=>e.chosen(t,o),key:t.name,tabindex:"0"},[(0,i.createVNode)(g,{emoji:t.char},null,8,["emoji"])],8,["title","onClick"])))),128))])):(0,i.createCommentVNode)("",!0)]),(0,i.createVNode)("div",l,[e.showPinned?((0,i.openBlock)(),(0,i.createBlock)("section",d,[(0,i.createVNode)("div",null,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.pinned,(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",onClick:o=>e.chosen(t,o),tabindex:"0"},[(0,i.createVNode)(g,{emoji:t,normal:!0},null,8,["emoji"])],8,["onClick"])))),256))])])):(0,i.createCommentVNode)("",!0),(0,i.createVNode)("section",null,[(0,i.createVNode)("header",m,[(0,i.createVNode)(y,{icon:e.faClock,"fixed-width":""},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(e.$ts.recentUsed),1)]),(0,i.createVNode)("div",null,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.$store.state.recentlyUsedEmojis,(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",onClick:o=>e.chosen(t,o),key:t},[(0,i.createVNode)(g,{emoji:t,normal:!0},null,8,["emoji"])],8,["onClick"])))),128))])]),(0,i.createVNode)("div",h,[(0,i.createVNode)(y,{icon:e.faChevronDown},null,8,["icon"])])]),((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.customEmojiCategories,(t=>((0,i.openBlock)(),(0,i.createBlock)("section",{key:"custom:"+t,class:"custom"},[(0,i.withDirectives)((0,i.createVNode)("header",{class:"_acrylic"},(0,i.toDisplayString)(t||e.$ts.other),513),[[x,()=>e.visibleCategories[t]=!0]]),e.visibleCategories[t]?((0,i.openBlock)(),(0,i.createBlock)("div",u,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.customEmojis.filter((e=>e.category===t)),(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",title:t.name,onClick:o=>e.chosen(t,o),key:t.name},[(0,i.createVNode)("img",{src:e.$store.state.disableShowingAnimatedImages?e.getStaticImageUrl(t.url):t.url},null,8,["src"])],8,["title","onClick"])))),128))])):(0,i.createCommentVNode)("",!0)])))),128)),((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.categories,(t=>((0,i.openBlock)(),(0,i.createBlock)("section",{key:t.name,class:"unicode"},[(0,i.withDirectives)((0,i.createVNode)("header",f,[(0,i.createVNode)(y,{icon:t.icon,"fixed-width":""},null,8,["icon"]),(0,i.createTextVNode)(" "+(0,i.toDisplayString)(t.name),1)],512),[[x,()=>t.isActive=!0]]),t.isActive?((0,i.openBlock)(),(0,i.createBlock)("div",p,[((0,i.openBlock)(!0),(0,i.createBlock)(i.Fragment,null,(0,i.renderList)(e.emojilist.filter((e=>e.category===t.name)),(t=>((0,i.openBlock)(),(0,i.createBlock)("button",{class:"_button",title:t.name,onClick:o=>e.chosen(t,o),key:t.name},[(0,i.createVNode)(g,{emoji:t.char},null,8,["emoji"])],8,["title","onClick"])))),128))])):(0,i.createCommentVNode)("",!0)])))),128))],512)],2)])),_:1},8,["src"])}));var v=o(59411),b=o(87774),g=o(51436),y=o(56024),B=o(89939),x=o(69345),w=o(10192),C=o(22275),j=o(11928),z=o(54929);const V=(0,i.defineComponent)({components:{MkModal:B.Z},props:{src:{required:!1},showPinned:{required:!1,default:!0},asReactionPicker:{required:!1}},emits:["done","closed"],data(){return{emojilist:(0,i.markRaw)(v.W),getStaticImageUrl:b.e,pinned:this.$store.state.reactions,width:this.asReactionPicker?this.$store.state.reactionPickerWidth:3,height:this.asReactionPicker?this.$store.state.reactionPickerHeight:2,big:!!this.asReactionPicker&&C.C,customEmojiCategories:z.lS,customEmojis:this.$instance.emojis,visibleCategories:{},q:null,searchResultCustom:[],searchResultUnicode:[],faGlobe:g.g4A,faClock:g.SZw,faChevronDown:g.ptq,categories:[{name:"face",icon:y.$B,isActive:!1},{name:"people",icon:g.ILF,isActive:!1},{name:"animals_and_nature",icon:g.XEC,isActive:!1},{name:"food_and_drink",icon:g.fkH,isActive:!1},{name:"activity",icon:g.O_4,isActive:!1},{name:"travel_and_places",icon:g.SBo,isActive:!1},{name:"objects",icon:g.RJo,isActive:!1},{name:"symbols",icon:y.m6,isActive:!1},{name:"flags",icon:y.Rr,isActive:!1}],faAsterisk:g.$X1}},watch:{q(){if(this.$refs.emojis.scrollTop=0,null==this.q||""===this.q)return this.searchResultCustom=[],void(this.searchResultUnicode=[]);const e=this.q.replace(/:/g,"");this.searchResultCustom=Array.from((()=>{const t=this.customEmojis,o=new Set,i=t.find((t=>t.name===e));if(i&&o.add(i),e.includes(" ")){const i=e.split(" ");for(const e of t)if(i.every((t=>e.name.includes(t)))&&(o.add(e),o.size>=8))break;if(o.size>=8)return o;for(const e of t)if(i.every((t=>e.name.includes(t)||e.aliases.some((e=>e.includes(t)))))&&(o.add(e),o.size>=8))break}else{for(const i of t)if(i.name.startsWith(e)&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.aliases.some((t=>t.startsWith(e)))&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.name.includes(e)&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.aliases.some((t=>t.includes(e)))&&(o.add(i),o.size>=8))break}return o})()),this.searchResultUnicode=Array.from((()=>{const t=this.emojilist,o=new Set,i=t.find((t=>t.name===e));if(i&&o.add(i),e.includes(" ")){const i=e.split(" ");for(const e of t)if(i.every((t=>e.name.includes(t)))&&(o.add(e),o.size>=8))break;if(o.size>=8)return o;for(const e of t)if(i.every((t=>e.name.includes(t)||e.keywords.some((e=>e.includes(t)))))&&(o.add(e),o.size>=8))break}else{for(const i of t)if(i.name.startsWith(e)&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.keywords.some((t=>t.startsWith(e)))&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.name.includes(e)&&(o.add(i),o.size>=8))break;if(o.size>=8)return o;for(const i of t)if(i.keywords.some((t=>t.includes(e)))&&(o.add(i),o.size>=8))break}return o})())}},mounted(){j.t||C.C||this.$refs.search.focus({preventScroll:!0})},methods:{getKey:e=>"string"==typeof e?e:e.char||`:${e.name}:`,chosen(e,t){if(t){const e=t.currentTarget||t.target,o=e.getBoundingClientRect(),i=o.left+e.clientWidth/2,a=o.top+e.clientHeight/2;w.gk(x.Z,{x:i,y:a},{},"end")}const o=this.getKey(e);if(this.$emit("done",o),this.$refs.modal.close(),!this.pinned.includes(o)){let e=this.$store.state.recentlyUsedEmojis;e=e.filter((e=>e!==o)),e.unshift(o),this.$store.set("recentlyUsedEmojis",e.splice(0,16))}},paste(e){const t=(e.clipboardData||window.clipboardData).getData("text");this.done(t)&&e.preventDefault()},done(e){if(null==e&&(e=this.q),null==e)return;const t=e.replace(/:/g,""),o=this.customEmojis.find((e=>e.name===t));if(o)return this.chosen(o),!0;const i=this.emojilist.find((e=>e.char===t||e.name===t));return i?(this.chosen(i),!0):this.searchResultCustom.length>0?(this.chosen(this.searchResultCustom[0]),!0):this.searchResultUnicode.length>0?(this.chosen(this.searchResultUnicode[0]),!0):void 0}}});o(18563);V.render=k,V.__scopeId="data-v-1538924a";const N=V},18563:(e,t,o)=>{var i=o(17256);"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,o(45346).Z)("c2635236",i,!0,{})}}]);