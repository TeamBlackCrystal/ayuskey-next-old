(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[6038],{4578:(t,e,a)=>{var s=a(23645)((function(t){return t[1]}));s.push([t.id,'.zbcjwnqg.max-width_1000px>.stats[data-v-74bfccfe]{grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr}.zbcjwnqg.max-width_550px>.stats[data-v-74bfccfe]{grid-template-columns:1fr;grid-template-rows:1fr 1fr 1fr 1fr}.zbcjwnqg>.stats[data-v-74bfccfe]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;grid-template-rows:1fr;gap:var(--margin);margin-bottom:var(--margin);font-size:90%}.zbcjwnqg>.stats>div[data-v-74bfccfe]{display:flex;box-sizing:border-box;padding:16px 20px}.zbcjwnqg>.stats>div>div[data-v-74bfccfe]{width:50%}.zbcjwnqg>.stats>div>div:first-child>b[data-v-74bfccfe]{display:block}.zbcjwnqg>.stats>div>div:first-child>b>[data-icon][data-v-74bfccfe]{width:16px;margin-right:8px}.zbcjwnqg>.stats>div>div:first-child>small[data-v-74bfccfe]{margin-left:24px;opacity:.7}.zbcjwnqg>.stats>div>div:last-child>dl[data-v-74bfccfe]{display:flex;margin:0;line-height:1.5em}.zbcjwnqg>.stats>div>div:last-child>dl>dd[data-v-74bfccfe],.zbcjwnqg>.stats>div>div:last-child>dl>dt[data-v-74bfccfe]{width:50%;margin:0}.zbcjwnqg>.stats>div>div:last-child>dl>dd[data-v-74bfccfe]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.zbcjwnqg>.stats>div>div:last-child>dl.total>dd[data-v-74bfccfe],.zbcjwnqg>.stats>div>div:last-child>dl.total>dt[data-v-74bfccfe]{font-weight:700}.zbcjwnqg>.stats>div>div:last-child>dl.diff.inc>dd[data-v-74bfccfe]{color:#82c11c}.zbcjwnqg>.stats>div>div:last-child>dl.diff.inc>dd[data-v-74bfccfe]:before{content:"+"}',""]),t.exports=s},46038:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>St});var s=a(55393);const o={key:0,class:"xhexznfu _section"},r={class:"_content"},i={class:"_keyValue"},l=(0,s.createVNode)("b",null,"Misskey",-1),n={key:0,class:"_content"},c={class:"_keyValue"},d=(0,s.createVNode)("b",null,"Node.js",-1),h={class:"_keyValue"},u=(0,s.createVNode)("b",null,"PostgreSQL",-1),p={class:"_keyValue"},m=(0,s.createVNode)("b",null,"Redis",-1),f={key:0,class:"_content"},v={style:{"border-collapse":"collapse",width:"100%"}},g=(0,s.createVNode)("tr",{style:{opacity:"0.7"}},[(0,s.createVNode)("th",{style:{"text-align":"left",padding:"0 8px 8px 0"}},"Table"),(0,s.createVNode)("th",{style:{"text-align":"left",padding:"0 8px 8px 0"}},"Records"),(0,s.createVNode)("th",{style:{"text-align":"left",padding:"0 0 8px 0"}},"Size")],-1),y={style:{"text-align":"left",padding:"0 8px 0 0","word-break":"break-all"}},N={style:{padding:"0 8px 0 0"}},V={style:{padding:"0",opacity:"0.7"}},b={key:1,class:"_section"},D={class:"_keyValue"},C={key:2};var S=a(51436),k=a(94566),w=a.n(k);const x=(0,s.withScopeId)("data-v-74bfccfe");(0,s.pushScopeId)("data-v-74bfccfe");const F={class:"zbcjwnqg"},$={key:0,class:"stats"},L={class:"_panel"},B={class:"total"},I={class:"_panel"},_={class:"total"},z={class:"_panel"},W={class:"total"},R={class:"_panel"},T={class:"total"},M={class:"_card"},U={class:"_title",style:{position:"relative"}},q={class:"_content",style:{"margin-top":"-8px"}},j={class:"selects",style:{display:"flex"}},A={value:"federation-instances"},O={value:"federation-instances-total"},P={value:"users"},H={value:"users-total"},Z={value:"active-users"},E={value:"notes"},J={value:"local-notes"},Q={value:"remote-notes"},X={value:"notes-total"},G={value:"drive-files"},Y={value:"drive-files-total"},K={value:"drive"},tt={value:"drive-total"},et={value:"hour"},at={value:"day"},st={ref:"chart"};(0,s.popScopeId)();const ot=x(((t,e,a,o,r,i)=>{const l=(0,s.resolveComponent)("Fa"),n=(0,s.resolveComponent)("MkSelect"),c=(0,s.resolveDirective)("size");return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)("div",F,[t.info?((0,s.openBlock)(),(0,s.createBlock)("div",$,[(0,s.createVNode)("div",L,[(0,s.createVNode)("div",null,[(0,s.createVNode)("b",null,[(0,s.createVNode)(l,{icon:t.faUser},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.users),1)]),(0,s.createVNode)("small",null,(0,s.toDisplayString)(t.$ts.local),1)]),(0,s.createVNode)("div",null,[(0,s.createVNode)("dl",B,[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.total),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.info.originalUsersCount)),1)]),(0,s.createVNode)("dl",{class:["diff",{inc:t.usersLocalDoD>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.dayOverDayChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.usersLocalDoD)),1)],2),(0,s.createVNode)("dl",{class:["diff",{inc:t.usersLocalWoW>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.weekOverWeekChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.usersLocalWoW)),1)],2)])]),(0,s.createVNode)("div",I,[(0,s.createVNode)("div",null,[(0,s.createVNode)("b",null,[(0,s.createVNode)(l,{icon:t.faUser},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.users),1)]),(0,s.createVNode)("small",null,(0,s.toDisplayString)(t.$ts.remote),1)]),(0,s.createVNode)("div",null,[(0,s.createVNode)("dl",_,[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.total),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.info.usersCount-t.info.originalUsersCount)),1)]),(0,s.createVNode)("dl",{class:["diff",{inc:t.usersRemoteDoD>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.dayOverDayChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.usersRemoteDoD)),1)],2),(0,s.createVNode)("dl",{class:["diff",{inc:t.usersRemoteWoW>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.weekOverWeekChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.usersRemoteWoW)),1)],2)])]),(0,s.createVNode)("div",z,[(0,s.createVNode)("div",null,[(0,s.createVNode)("b",null,[(0,s.createVNode)(l,{icon:t.faPencilAlt},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.notes),1)]),(0,s.createVNode)("small",null,(0,s.toDisplayString)(t.$ts.local),1)]),(0,s.createVNode)("div",null,[(0,s.createVNode)("dl",W,[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.total),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.info.originalNotesCount)),1)]),(0,s.createVNode)("dl",{class:["diff",{inc:t.notesLocalDoD>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.dayOverDayChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.notesLocalDoD)),1)],2),(0,s.createVNode)("dl",{class:["diff",{inc:t.notesLocalWoW>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.weekOverWeekChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.notesLocalWoW)),1)],2)])]),(0,s.createVNode)("div",R,[(0,s.createVNode)("div",null,[(0,s.createVNode)("b",null,[(0,s.createVNode)(l,{icon:t.faPencilAlt},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.notes),1)]),(0,s.createVNode)("small",null,(0,s.toDisplayString)(t.$ts.remote),1)]),(0,s.createVNode)("div",null,[(0,s.createVNode)("dl",T,[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.total),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.info.notesCount-t.info.originalNotesCount)),1)]),(0,s.createVNode)("dl",{class:["diff",{inc:t.notesRemoteDoD>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.dayOverDayChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.notesRemoteDoD)),1)],2),(0,s.createVNode)("dl",{class:["diff",{inc:t.notesRemoteWoW>0}]},[(0,s.createVNode)("dt",null,(0,s.toDisplayString)(t.$ts.weekOverWeekChanges),1),(0,s.createVNode)("dd",null,(0,s.toDisplayString)(t.number(t.notesRemoteWoW)),1)],2)])])])):(0,s.createCommentVNode)("",!0),(0,s.createVNode)("section",M,[(0,s.createVNode)("div",U,[(0,s.createVNode)(l,{icon:t.faChartBar},null,8,["icon"]),(0,s.createTextVNode)(" "+(0,s.toDisplayString)(t.$ts.statistics),1),(0,s.createVNode)("button",{onClick:e[1]||(e[1]=(...e)=>t.fetchChart&&t.fetchChart(...e)),class:"_button",style:{position:"absolute",right:"0",bottom:"0",top:"0",padding:"inherit"}},[(0,s.createVNode)(l,{icon:t.faSync},null,8,["icon"])])]),(0,s.createVNode)("div",q,[(0,s.createVNode)("div",j,[(0,s.createVNode)(n,{value:t.chartSrc,"onUpdate:value":e[2]||(e[2]=e=>t.chartSrc=e),style:{margin:"0",flex:"1"}},{default:x((()=>[(0,s.createVNode)("optgroup",{label:t.$ts.federation},[(0,s.createVNode)("option",A,(0,s.toDisplayString)(t.$ts._charts.federationInstancesIncDec),1),(0,s.createVNode)("option",O,(0,s.toDisplayString)(t.$ts._charts.federationInstancesTotal),1)],8,["label"]),(0,s.createVNode)("optgroup",{label:t.$ts.users},[(0,s.createVNode)("option",P,(0,s.toDisplayString)(t.$ts._charts.usersIncDec),1),(0,s.createVNode)("option",H,(0,s.toDisplayString)(t.$ts._charts.usersTotal),1),(0,s.createVNode)("option",Z,(0,s.toDisplayString)(t.$ts._charts.activeUsers),1)],8,["label"]),(0,s.createVNode)("optgroup",{label:t.$ts.notes},[(0,s.createVNode)("option",E,(0,s.toDisplayString)(t.$ts._charts.notesIncDec),1),(0,s.createVNode)("option",J,(0,s.toDisplayString)(t.$ts._charts.localNotesIncDec),1),(0,s.createVNode)("option",Q,(0,s.toDisplayString)(t.$ts._charts.remoteNotesIncDec),1),(0,s.createVNode)("option",X,(0,s.toDisplayString)(t.$ts._charts.notesTotal),1)],8,["label"]),(0,s.createVNode)("optgroup",{label:t.$ts.drive},[(0,s.createVNode)("option",G,(0,s.toDisplayString)(t.$ts._charts.filesIncDec),1),(0,s.createVNode)("option",Y,(0,s.toDisplayString)(t.$ts._charts.filesTotal),1),(0,s.createVNode)("option",K,(0,s.toDisplayString)(t.$ts._charts.storageUsageIncDec),1),(0,s.createVNode)("option",tt,(0,s.toDisplayString)(t.$ts._charts.storageUsageTotal),1)],8,["label"])])),_:1},8,["value"]),(0,s.createVNode)(n,{value:t.chartSpan,"onUpdate:value":e[3]||(e[3]=e=>t.chartSpan=e),style:{margin:"0"}},{default:x((()=>[(0,s.createVNode)("option",et,(0,s.toDisplayString)(t.$ts.perHour),1),(0,s.createVNode)("option",at,(0,s.toDisplayString)(t.$ts.perDay),1)])),_:1},8,["value"])]),(0,s.createVNode)("canvas",st,null,512)])])],512)),[[c,{max:[550,1e3]}]])}));var rt=a(17757),it=a.n(rt),lt=a(66018),nt=a(92906),ct=a(10192);const dt=(...t)=>t.reduce(((t,e)=>t.map(((t,a)=>e[a]+t)))),ht=t=>t.map((t=>-t)),ut=(t,e)=>{const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return`rgba(${parseInt(a[1],16)}, ${parseInt(a[2],16)}, ${parseInt(a[3],16)}, ${e})`},pt=(0,s.defineComponent)({components:{MkSelect:lt.Z},props:{chartLimit:{type:Number,required:!1,default:90},detailed:{type:Boolean,required:!1,default:!1}},data:()=>({info:null,notesLocalWoW:0,notesLocalDoD:0,notesRemoteWoW:0,notesRemoteDoD:0,usersLocalWoW:0,usersLocalDoD:0,usersRemoteWoW:0,usersRemoteDoD:0,now:null,chart:null,chartInstance:null,chartSrc:"notes",chartSpan:"hour",faChartBar:S.koM,faUser:S.ILF,faPencilAlt:S.UJf,faSync:S.UO1}),computed:{data(){if(null==this.chart)return null;switch(this.chartSrc){case"federation-instances":return this.federationInstancesChart(!1);case"federation-instances-total":return this.federationInstancesChart(!0);case"users":return this.usersChart(!1);case"users-total":return this.usersChart(!0);case"active-users":return this.activeUsersChart();case"notes":return this.notesChart("combined");case"local-notes":return this.notesChart("local");case"remote-notes":return this.notesChart("remote");case"notes-total":return this.notesTotalChart();case"drive":return this.driveChart();case"drive-total":return this.driveTotalChart();case"drive-files":return this.driveFilesChart();case"drive-files-total":return this.driveFilesTotalChart()}},stats(){return"day"==this.chartSpan?this.chart.perDay:"hour"==this.chartSpan?this.chart.perHour:null}},watch:{chartSrc(){this.renderChart()},chartSpan(){this.renderChart()}},async created(){this.info=await ct.hi("stats"),this.now=new Date,this.fetchChart()},methods:{async fetchChart(){const[t,e]=await Promise.all([Promise.all([ct.hi("charts/federation",{limit:this.chartLimit,span:"hour"}),ct.hi("charts/users",{limit:this.chartLimit,span:"hour"}),ct.hi("charts/active-users",{limit:this.chartLimit,span:"hour"}),ct.hi("charts/notes",{limit:this.chartLimit,span:"hour"}),ct.hi("charts/drive",{limit:this.chartLimit,span:"hour"})]),Promise.all([ct.hi("charts/federation",{limit:this.chartLimit,span:"day"}),ct.hi("charts/users",{limit:this.chartLimit,span:"day"}),ct.hi("charts/active-users",{limit:this.chartLimit,span:"day"}),ct.hi("charts/notes",{limit:this.chartLimit,span:"day"}),ct.hi("charts/drive",{limit:this.chartLimit,span:"day"})])]),a={perHour:{federation:t[0],users:t[1],activeUsers:t[2],notes:t[3],drive:t[4]},perDay:{federation:e[0],users:e[1],activeUsers:e[2],notes:e[3],drive:e[4]}};this.notesLocalWoW=this.info.originalNotesCount-a.perDay.notes.local.total[7],this.notesLocalDoD=this.info.originalNotesCount-a.perDay.notes.local.total[1],this.notesRemoteWoW=this.info.notesCount-this.info.originalNotesCount-a.perDay.notes.remote.total[7],this.notesRemoteDoD=this.info.notesCount-this.info.originalNotesCount-a.perDay.notes.remote.total[1],this.usersLocalWoW=this.info.originalUsersCount-a.perDay.users.local.total[7],this.usersLocalDoD=this.info.originalUsersCount-a.perDay.users.local.total[1],this.usersRemoteWoW=this.info.usersCount-this.info.originalUsersCount-a.perDay.users.remote.total[7],this.usersRemoteDoD=this.info.usersCount-this.info.originalUsersCount-a.perDay.users.remote.total[1],this.chart=a,this.renderChart()},renderChart(){this.chartInstance&&this.chartInstance.destroy();const t=this.$store.state.darkMode?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";it().defaults.global.defaultFontColor=getComputedStyle(document.documentElement).getPropertyValue("--fg"),this.chartInstance=(0,s.markRaw)(new(it())(this.$refs.chart,{type:"line",data:{labels:new Array(this.chartLimit).fill(0).map(((t,e)=>this.getDate(e).toLocaleString())).slice().reverse(),datasets:this.data.series.map((t=>({label:t.name,data:t.data.slice().reverse(),pointRadius:0,lineTension:0,borderWidth:2,borderColor:t.color,borderDash:t.borderDash||[],backgroundColor:ut(t.color,.1),fill:null==t.fill||t.fill,hidden:!!t.hidden})))},options:{aspectRatio:2.5,layout:{padding:{left:0,right:0,top:16,bottom:0}},legend:{position:"bottom",labels:{boxWidth:16}},scales:{xAxes:[{type:"time",time:{stepSize:1,unit:"day"==this.chartSpan?"month":"day"},gridLines:{display:this.detailed,color:t,zeroLineColor:t},ticks:{display:this.detailed}}],yAxes:[{position:"left",gridLines:{color:t,zeroLineColor:t},ticks:{display:this.detailed}}]},tooltips:{intersect:!1,mode:"index"}}}))},getDate(t){const e=this.now.getFullYear(),a=this.now.getMonth(),s=this.now.getDate(),o=this.now.getHours();return"day"==this.chartSpan?new Date(e,a,s-t):new Date(e,a,s,o-t)},format(t){const e=Date.now();return t.map(((t,a)=>({x:new Date(e-("day"==this.chartSpan?864e5:36e5)*a),y:t})))},federationInstancesChart(t){return{series:[{name:"Instances",color:"#008FFB",data:this.format(t?this.stats.federation.instance.total:dt(this.stats.federation.instance.inc,ht(this.stats.federation.instance.dec)))}]}},notesChart(t){return{series:[{name:"All",type:"line",color:"#008FFB",borderDash:[5,5],fill:!1,data:this.format("combined"==t?dt(this.stats.notes.local.inc,ht(this.stats.notes.local.dec),this.stats.notes.remote.inc,ht(this.stats.notes.remote.dec)):dt(this.stats.notes[t].inc,ht(this.stats.notes[t].dec)))},{name:"Renotes",type:"area",color:"#00E396",data:this.format("combined"==t?dt(this.stats.notes.local.diffs.renote,this.stats.notes.remote.diffs.renote):this.stats.notes[t].diffs.renote)},{name:"Replies",type:"area",color:"#FEB019",data:this.format("combined"==t?dt(this.stats.notes.local.diffs.reply,this.stats.notes.remote.diffs.reply):this.stats.notes[t].diffs.reply)},{name:"Normal",type:"area",color:"#FF4560",data:this.format("combined"==t?dt(this.stats.notes.local.diffs.normal,this.stats.notes.remote.diffs.normal):this.stats.notes[t].diffs.normal)}]}},notesTotalChart(){return{series:[{name:"Combined",type:"line",color:"#008FFB",data:this.format(dt(this.stats.notes.local.total,this.stats.notes.remote.total))},{name:"Local",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.notes.local.total)},{name:"Remote",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.notes.remote.total)}]}},usersChart(t){return{series:[{name:"Combined",type:"line",color:"#008FFB",data:this.format(t?dt(this.stats.users.local.total,this.stats.users.remote.total):dt(this.stats.users.local.inc,ht(this.stats.users.local.dec),this.stats.users.remote.inc,ht(this.stats.users.remote.dec)))},{name:"Local",type:"area",color:"#008FFB",hidden:!0,data:this.format(t?this.stats.users.local.total:dt(this.stats.users.local.inc,ht(this.stats.users.local.dec)))},{name:"Remote",type:"area",color:"#008FFB",hidden:!0,data:this.format(t?this.stats.users.remote.total:dt(this.stats.users.remote.inc,ht(this.stats.users.remote.dec)))}]}},activeUsersChart(){return{series:[{name:"Combined",type:"line",color:"#008FFB",data:this.format(dt(this.stats.activeUsers.local.count,this.stats.activeUsers.remote.count))},{name:"Local",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.activeUsers.local.count)},{name:"Remote",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.activeUsers.remote.count)}]}},driveChart(){return{bytes:!0,series:[{name:"All",type:"line",color:"#09d8e2",borderDash:[5,5],fill:!1,data:this.format(dt(this.stats.drive.local.incSize,ht(this.stats.drive.local.decSize),this.stats.drive.remote.incSize,ht(this.stats.drive.remote.decSize)))},{name:"Local +",type:"area",color:"#008FFB",data:this.format(this.stats.drive.local.incSize)},{name:"Local -",type:"area",color:"#FF4560",data:this.format(ht(this.stats.drive.local.decSize))},{name:"Remote +",type:"area",color:"#00E396",data:this.format(this.stats.drive.remote.incSize)},{name:"Remote -",type:"area",color:"#FEB019",data:this.format(ht(this.stats.drive.remote.decSize))}]}},driveTotalChart(){return{bytes:!0,series:[{name:"Combined",type:"line",color:"#008FFB",data:this.format(dt(this.stats.drive.local.totalSize,this.stats.drive.remote.totalSize))},{name:"Local",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.drive.local.totalSize)},{name:"Remote",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.drive.remote.totalSize)}]}},driveFilesChart(){return{series:[{name:"All",type:"line",color:"#09d8e2",borderDash:[5,5],fill:!1,data:this.format(dt(this.stats.drive.local.incCount,ht(this.stats.drive.local.decCount),this.stats.drive.remote.incCount,ht(this.stats.drive.remote.decCount)))},{name:"Local +",type:"area",color:"#008FFB",data:this.format(this.stats.drive.local.incCount)},{name:"Local -",type:"area",color:"#FF4560",data:this.format(ht(this.stats.drive.local.decCount))},{name:"Remote +",type:"area",color:"#00E396",data:this.format(this.stats.drive.remote.incCount)},{name:"Remote -",type:"area",color:"#FEB019",data:this.format(ht(this.stats.drive.remote.decCount))}]}},driveFilesTotalChart(){return{series:[{name:"Combined",type:"line",color:"#008FFB",data:this.format(dt(this.stats.drive.local.totalCount,this.stats.drive.remote.totalCount))},{name:"Local",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.drive.local.totalCount)},{name:"Remote",type:"area",color:"#008FFB",hidden:!0,data:this.format(this.stats.drive.remote.totalCount)}]}},number:nt.Z}});a(89514);pt.render=ot,pt.__scopeId="data-v-74bfccfe";const mt=pt;var ft=a(42453),vt=a(77121),gt=a(69146),yt=a(44219),Nt=a(34862),Vt=a(59092),bt=a(61436),Dt=a(17046);const Ct=(0,s.defineComponent)({components:{MkInstanceStats:mt,MkButton:ft.Z,MkSelect:lt.Z,MkInput:vt.Z,MkContainer:gt.Z,MkFolder:yt.Z,XMetrics:Dt.default,VueJsonPretty:w()},data(){return{INFO:{tabs:[{id:"index",title:null,tooltip:this.$ts.instance,icon:S.xf3,onClick:()=>{this.page="index"},selected:(0,s.computed)((()=>"index"===this.page))},{id:"metrics",title:null,tooltip:this.$ts.metrics,icon:S.s2n,onClick:()=>{this.page="metrics"},selected:(0,s.computed)((()=>"metrics"===this.page))},{id:"logs",title:null,tooltip:this.$ts.logs,icon:S.aC2,onClick:()=>{this.page="logs"},selected:(0,s.computed)((()=>"logs"===this.page))}]},page:"index",version:Nt.i8,url:Nt.HQ,stats:null,serverInfo:null,modLogs:[],dbInfo:null,faPlay:S.zc,faPause:S.XQY,faDatabase:S.t5N,faServer:S.xf3,faExchangeAlt:S.Ssp,faMicrochip:S.zvy,faHdd:S.vc8,faStream:S.aC2,faTrashAlt:S.I7k,faInfoCircle:S.sqG,faExclamationTriangle:S.eHv,faTachometerAlt:S.HLz,faHeartbeat:S.s2n,faClipboardList:S.OGB}},computed:{meta(){return this.$instance}},mounted(){this.fetchJobs(),this.fetchModLogs(),ct.hi("admin/server-info",{}).then((t=>{this.serverInfo=t})),ct.hi("admin/get-table-stats",{}).then((t=>{this.dbInfo=Object.entries(t).sort(((t,e)=>e[1].size-t[1].size))}))},methods:{async showInstanceInfo(t){let e=t;"string"==typeof t&&(e=await ct.hi("federation/show-instance",{host:t})),ct.gk(bt.default,{instance:e},{},"closed")},fetchJobs(){ct.hi("admin/queue/deliver-delayed",{}).then((t=>{this.jobs=t}))},fetchModLogs(){ct.hi("admin/show-moderation-logs",{}).then((t=>{this.modLogs=t}))},bytes:Vt.Z,number:nt.Z}});Ct.render=function(t,e,a,S,k,w){const x=(0,s.resolveComponent)("Fa"),F=(0,s.resolveComponent)("MkInstanceStats"),$=(0,s.resolveComponent)("MkContainer"),L=(0,s.resolveComponent)("MkFolder"),B=(0,s.resolveComponent)("MkTime"),I=(0,s.resolveComponent)("XMetrics");return(0,s.openBlock)(),(0,s.createBlock)(s.Fragment,null,[t.meta?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)("div",o,[(0,s.createVNode)(L,null,{header:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{icon:t.faTachometerAlt},null,8,["icon"]),(0,s.createTextVNode)(" "+(0,s.toDisplayString)(t.$ts.overview),1)])),default:(0,s.withCtx)((()=>[(0,s.createVNode)("div",{class:"sboqnrfi",style:{gridTemplateRows:t.overviewHeight}},[(0,s.createVNode)(F,{"chart-limit":300,detailed:!0,class:"_vMargin",ref:"stats"},null,512),(0,s.createVNode)($,{"body-togglable":!0,class:"_vMargin"},{header:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{icon:t.faInfoCircle},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.instanceInfo),1)])),default:(0,s.withCtx)((()=>[(0,s.createVNode)("div",r,[(0,s.createVNode)("div",i,[l,(0,s.createVNode)("span",null,"v"+(0,s.toDisplayString)(t.version),1)])]),t.serverInfo?((0,s.openBlock)(),(0,s.createBlock)("div",n,[(0,s.createVNode)("div",c,[d,(0,s.createVNode)("span",null,(0,s.toDisplayString)(t.serverInfo.node),1)]),(0,s.createVNode)("div",h,[u,(0,s.createVNode)("span",null,"v"+(0,s.toDisplayString)(t.serverInfo.psql),1)]),(0,s.createVNode)("div",p,[m,(0,s.createVNode)("span",null,"v"+(0,s.toDisplayString)(t.serverInfo.redis),1)])])):(0,s.createCommentVNode)("",!0)])),_:1}),(0,s.createVNode)($,{"body-togglable":!0,scrollable:!0,class:"_vMargin",style:{height:"300px"}},{header:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{icon:t.faDatabase},null,8,["icon"]),(0,s.createTextVNode)((0,s.toDisplayString)(t.$ts.database),1)])),default:(0,s.withCtx)((()=>[t.dbInfo?((0,s.openBlock)(),(0,s.createBlock)("div",f,[(0,s.createVNode)("table",v,[g,((0,s.openBlock)(!0),(0,s.createBlock)(s.Fragment,null,(0,s.renderList)(t.dbInfo,(e=>((0,s.openBlock)(),(0,s.createBlock)("tr",{key:e[0]},[(0,s.createVNode)("th",y,(0,s.toDisplayString)(e[0]),1),(0,s.createVNode)("td",N,(0,s.toDisplayString)(t.number(e[1].count)),1),(0,s.createVNode)("td",V,(0,s.toDisplayString)(t.bytes(e[1].size)),1)])))),128))])])):(0,s.createCommentVNode)("",!0)])),_:1})],4)])),_:1})],512)),[[s.vShow,"index"===t.page]]):(0,s.createCommentVNode)("",!0),"logs"===t.page?((0,s.openBlock)(),(0,s.createBlock)("div",b,[(0,s.createVNode)(L,null,{header:(0,s.withCtx)((()=>[(0,s.createVNode)(x,{icon:t.faStream},null,8,["icon"]),(0,s.createTextVNode)(" "+(0,s.toDisplayString)(t.$ts.logs),1)])),default:(0,s.withCtx)((()=>[((0,s.openBlock)(!0),(0,s.createBlock)(s.Fragment,null,(0,s.renderList)(t.modLogs,(t=>((0,s.openBlock)(),(0,s.createBlock)("div",D,[(0,s.createVNode)("b",null,(0,s.toDisplayString)(t.type),1),(0,s.createVNode)("span",null,"by "+(0,s.toDisplayString)(t.user.username),1),(0,s.createVNode)(B,{time:t.createdAt,style:{opacity:"0.7"}},null,8,["time"])])))),256))])),_:1})])):(0,s.createCommentVNode)("",!0),"metrics"===t.page?((0,s.openBlock)(),(0,s.createBlock)("div",C,[(0,s.createVNode)(I)])):(0,s.createCommentVNode)("",!0)],64)};const St=Ct},89514:(t,e,a)=>{var s=a(4578);"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals);(0,a(45346).Z)("5c600610",s,!0,{})}}]);