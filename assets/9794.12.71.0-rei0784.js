(self.webpackChunkmisskey=self.webpackChunkmisskey||[]).push([[9794],{62960:(e,t,o)=>{var a=o(23645)((function(e){return e[1]}));a.push([e.id,".container-toggle-enter-active[data-v-1dbdaf33],.container-toggle-leave-active[data-v-1dbdaf33]{overflow-y:hidden;transition:opacity .5s,height .5s!important}.container-toggle-enter-from[data-v-1dbdaf33],.container-toggle-leave-to[data-v-1dbdaf33]{opacity:0}.ukygtjoj[data-v-1dbdaf33]{position:relative;overflow:hidden}.ukygtjoj.naked[data-v-1dbdaf33]{background:transparent!important;box-shadow:none!important}.ukygtjoj.scrollable[data-v-1dbdaf33]{display:flex;flex-direction:column}.ukygtjoj.scrollable>div[data-v-1dbdaf33]{overflow:auto}.ukygtjoj>header[data-v-1dbdaf33]{position:relative;color:var(--panelHeaderFg);background:var(--panelHeaderBg);box-shadow:0 1px 0 0 var(--panelHeaderDivider);z-index:2;line-height:1.4em}.ukygtjoj>header>.title[data-v-1dbdaf33]{margin:0;padding:12px 16px}.ukygtjoj>header>.title[data-v-1dbdaf33]> [data-icon]{margin-right:6px}.ukygtjoj>header>.title[data-v-1dbdaf33]:empty{display:none}.ukygtjoj>header>.sub[data-v-1dbdaf33]{position:absolute;z-index:2;top:0;right:0;height:100%}.ukygtjoj>header>.sub[data-v-1dbdaf33]> button{width:42px;height:100%}.ukygtjoj>div[data-v-1dbdaf33]> ._content{padding:24px}.ukygtjoj>div[data-v-1dbdaf33]> ._content+._content{border-top:1px solid var(--divider)}.ukygtjoj.max-width_380px>header>.title[data-v-1dbdaf33]{padding:8px 10px;font-size:.9em}.ukygtjoj.max-width_380px>div[data-v-1dbdaf33]> ._content{padding:16px}._forceContainerFull_ .ukygtjoj>header>.title[data-v-1dbdaf33]{padding:12px 16px!important}._forceContainerFull_.ukygtjoj>header>.title[data-v-1dbdaf33]{padding:12px 16px!important}",""]),e.exports=a},20694:(e,t,o)=>{var a=o(23645)((function(e){return e[1]}));a.push([e.id,"svg[data-v-5836d50f]{display:block;padding:16px;width:100%;box-sizing:border-box}svg>rect[data-v-5836d50f]{transform-origin:center}svg>rect.day[data-v-5836d50f]:hover{fill:rgba(0,0,0,.05)}",""]),e.exports=a},46795:(e,t,o)=>{var a=o(23645)((function(e){return e[1]}));a.push([e.id,"svg[data-v-211b59b5]{display:block;padding:16px;width:100%;box-sizing:border-box;cursor:all-scroll}",""]),e.exports=a},46397:(e,t,o)=>{"use strict";o.d(t,{Z:()=>s});var a=o(55393),n=o(51084),i=o(10192);function s(e){return(0,a.defineComponent)({props:{widget:{type:Object,required:!1},settingCallback:{required:!1}},emits:["updateProps"],data(){return{props:this.widget?JSON.parse(JSON.stringify(this.widget.data)):{},save:(0,n.P)(3e3,(()=>{this.$emit("updateProps",this.props)}))}},computed:{id(){return this.widget?this.widget.id:null}},created(){this.mergeProps(),this.$watch("props",(()=>{this.mergeProps()}),{deep:!0}),this.settingCallback&&this.settingCallback(this.setting)},methods:{mergeProps(){if(e.props){const t=e.props();for(const e of Object.keys(t))this.props.hasOwnProperty(e)||(this.props[e]=t[e].default)}},async setting(){const t=e.props();for(const e of Object.keys(t))t[e].default=this.props[e];const{canceled:o,result:a}=await i.cr(e.name,t);if(!o){for(const e of Object.keys(a))this.props[e]=a[e];this.save()}}}})}},69146:(e,t,o)=>{"use strict";o.d(t,{Z:()=>c});var a=o(55393);const n=(0,a.withScopeId)("data-v-1dbdaf33");(0,a.pushScopeId)("data-v-1dbdaf33");const i={key:0,ref:"header"},s={class:"title"},d={class:"sub"};(0,a.popScopeId)();const r=n(((e,t,o,r,l,p)=>{const c=(0,a.resolveComponent)("Fa"),h=(0,a.resolveDirective)("size");return(0,a.withDirectives)(((0,a.openBlock)(),(0,a.createBlock)("div",{class:["ukygtjoj _panel",{naked:e.naked,hideHeader:!e.showHeader,scrollable:e.scrollable,closed:!e.showBody}]},[e.showHeader?((0,a.openBlock)(),(0,a.createBlock)("header",i,[(0,a.createVNode)("div",s,[(0,a.renderSlot)(e.$slots,"header")]),(0,a.createVNode)("div",d,[(0,a.renderSlot)(e.$slots,"func"),e.bodyTogglable?((0,a.openBlock)(),(0,a.createBlock)("button",{key:0,class:"_button",onClick:t[1]||(t[1]=()=>e.showBody=!e.showBody)},[e.showBody?((0,a.openBlock)(),(0,a.createBlock)(c,{key:0,icon:e.faAngleUp},null,8,["icon"])):((0,a.openBlock)(),(0,a.createBlock)(c,{key:1,icon:e.faAngleDown},null,8,["icon"]))])):(0,a.createCommentVNode)("",!0)])],512)):(0,a.createCommentVNode)("",!0),(0,a.createVNode)(a.Transition,{name:"container-toggle",onEnter:e.enter,onAfterEnter:e.afterEnter,onLeave:e.leave,onAfterLeave:e.afterLeave},{default:n((()=>[(0,a.withDirectives)((0,a.createVNode)("div",null,[(0,a.renderSlot)(e.$slots,"default")],512),[[a.vShow,e.showBody]])])),_:3},8,["onEnter","onAfterEnter","onLeave","onAfterLeave"])],2)),[[h,{max:[380]}]])}));var l=o(51436);const p=(0,a.defineComponent)({props:{showHeader:{type:Boolean,required:!1,default:!0},naked:{type:Boolean,required:!1,default:!1},bodyTogglable:{type:Boolean,required:!1,default:!1},expanded:{type:Boolean,required:!1,default:!0},scrollable:{type:Boolean,required:!1,default:!1}},data(){return{showBody:this.expanded,faAngleUp:l.onQ,faAngleDown:l.gc2}},mounted(){this.$watch("showBody",(e=>{const t=this.showHeader?this.$refs.header.offsetHeight:0;this.$el.style.minHeight=t+"px",this.$el.style.flexBasis=e?"auto":t+"px"}),{immediate:!0})},methods:{toggleContent(e){this.bodyTogglable&&(this.showBody=e)},enter(e){const t=e.getBoundingClientRect().height;e.style.height=0,e.offsetHeight,e.style.height=t+"px"},afterEnter(e){e.style.height=null},leave(e){const t=e.getBoundingClientRect().height;e.style.height=t+"px",e.offsetHeight,e.style.height=0},afterLeave(e){e.style.height=null}}});o(64935);p.render=r,p.__scopeId="data-v-1dbdaf33";const c=p},19794:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>k});var a=o(55393);var n=o(51436),i=o(69146),s=o(46397);const d=(0,a.withScopeId)("data-v-5836d50f");(0,a.pushScopeId)("data-v-5836d50f");const r={viewBox:"0 0 21 7"};(0,a.popScopeId)();const l=d(((e,t,o,n,i,s)=>((0,a.openBlock)(),(0,a.createBlock)("svg",r,[((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(e.data,(e=>((0,a.openBlock)(),(0,a.createBlock)("rect",{class:"day",width:"1",height:"1",x:e.x,y:e.date.weekday,rx:"1",ry:"1",fill:"transparent"},[(0,a.createVNode)("title",null,(0,a.toDisplayString)(e.date.year)+"/"+(0,a.toDisplayString)(e.date.month+1)+"/"+(0,a.toDisplayString)(e.date.day),1)],8,["x","y"])))),256)),((0,a.openBlock)(!0),(0,a.createBlock)(a.Fragment,null,(0,a.renderList)(e.data,(e=>((0,a.openBlock)(),(0,a.createBlock)("rect",{class:"day",width:e.v,height:e.v,x:e.x+(1-e.v)/2,y:e.date.weekday+(1-e.v)/2,rx:"1",ry:"1",fill:e.color,style:{"pointer-events":"none"}},null,8,["width","height","x","y","fill"])))),256)),(0,a.createVNode)("rect",{class:"today",width:"1",height:"1",x:e.data[0].x,y:e.data[0].date.weekday,rx:"1",ry:"1",fill:"none","stroke-width":"0.1",stroke:"#f73520"},null,8,["x","y"])])))),p=(0,a.defineComponent)({props:["data"],created(){for(const e of this.data)e.total=e.notes+e.replies+e.renotes;const e=Math.max.apply(null,this.data.map((e=>e.total))),t=new Date,o=t.getFullYear(),a=t.getMonth(),n=t.getDate();let i=20;this.data.slice().forEach(((t,s)=>{t.x=i;const d=new Date(o,a,n-s);t.date={year:d.getFullYear(),month:d.getMonth(),day:d.getDate(),weekday:d.getDay()},t.v=0===e?0:t.total/(e/2),t.v>1&&(t.v=1);const r=0===t.date.weekday||6===t.date.weekday?275:170,l=100*t.v,p=15+80*(1-t.v);t.color=`hsl(${r}, ${l}%, ${p}%)`,0===t.date.weekday&&i--}))}});o(27633);p.render=l,p.__scopeId="data-v-5836d50f";const c=p,h=(0,a.withScopeId)("data-v-211b59b5")(((e,t,o,n,i,s)=>((0,a.openBlock)(),(0,a.createBlock)("svg",{viewBox:`0 0 ${e.viewBoxX} ${e.viewBoxY}`,onMousedown:t[1]||(t[1]=(0,a.withModifiers)(((...t)=>e.onMousedown&&e.onMousedown(...t)),["prevent"]))},[(0,a.createVNode)("polyline",{points:e.pointsNote,fill:"none","stroke-width":"1",stroke:"#41ddde"},null,8,["points"]),(0,a.createVNode)("polyline",{points:e.pointsReply,fill:"none","stroke-width":"1",stroke:"#f7796c"},null,8,["points"]),(0,a.createVNode)("polyline",{points:e.pointsRenote,fill:"none","stroke-width":"1",stroke:"#a1de41"},null,8,["points"]),(0,a.createVNode)("polyline",{points:e.pointsTotal,fill:"none","stroke-width":"1",stroke:"#555","stroke-dasharray":"2 2"},null,8,["points"])],40,["viewBox"]))));function v(e){window.removeEventListener("mousemove",e),window.removeEventListener("mouseleave",v),window.removeEventListener("mouseup",v)}const f=(0,a.defineComponent)({props:["data"],data:()=>({viewBoxX:147,viewBoxY:60,zoom:1,pos:0,pointsNote:null,pointsReply:null,pointsRenote:null,pointsTotal:null}),created(){for(const e of this.data)e.total=e.notes+e.replies+e.renotes;this.render()},methods:{render(){const e=Math.max.apply(null,this.data.map((e=>e.total)));if(0!=e){const t=this.data.slice().reverse();this.pointsNote=t.map(((t,o)=>`${o*this.zoom+this.pos},${(1-t.notes/e)*this.viewBoxY}`)).join(" "),this.pointsReply=t.map(((t,o)=>`${o*this.zoom+this.pos},${(1-t.replies/e)*this.viewBoxY}`)).join(" "),this.pointsRenote=t.map(((t,o)=>`${o*this.zoom+this.pos},${(1-t.renotes/e)*this.viewBoxY}`)).join(" "),this.pointsTotal=t.map(((t,o)=>`${o*this.zoom+this.pos},${(1-t.total/e)*this.viewBoxY}`)).join(" ")}},onMousedown(e){const t=e.clientX,o=e.clientY,a=this.zoom,n=this.pos;var i;i=e=>{let i=e.clientX-t,s=e.clientY-o;this.zoom=a+-s/20,this.pos=n+i,this.zoom<1&&(this.zoom=1),this.pos>0&&(this.pos=0),this.pos<-((this.data.length-1)*this.zoom-this.viewBoxX)&&(this.pos=-((this.data.length-1)*this.zoom-this.viewBoxX)),this.render()},window.addEventListener("mousemove",i),window.addEventListener("mouseleave",v.bind(null,i)),window.addEventListener("mouseup",v.bind(null,i))}}});o(36833);f.render=h,f.__scopeId="data-v-211b59b5";const u=f;var g=o(10192);const y=(0,s.Z)({name:"activity",props:()=>({showHeader:{type:"boolean",default:!0},transparent:{type:"boolean",default:!1},view:{type:"number",default:0,hidden:!0}})}),w=(0,a.defineComponent)({extends:y,components:{MkContainer:i.Z,XCalendar:c,XChart:u},data:()=>({fetching:!0,activity:null,faChartBar:n.koM,faSort:n.CmM}),mounted(){g.hi("charts/user/notes",{userId:this.$i.id,span:"day",limit:147}).then((e=>{this.activity=e.diffs.normal.map(((t,o)=>({total:e.diffs.normal[o]+e.diffs.reply[o]+e.diffs.renote[o],notes:e.diffs.normal[o],replies:e.diffs.reply[o],renotes:e.diffs.renote[o]}))),this.fetching=!1}))},methods:{toggleView(){1===this.props.view?this.props.view=0:this.props.view++,this.save()}}});w.render=function(e,t,o,n,i,s){const d=(0,a.resolveComponent)("Fa"),r=(0,a.resolveComponent)("MkLoading"),l=(0,a.resolveComponent)("XCalendar"),p=(0,a.resolveComponent)("XChart"),c=(0,a.resolveComponent)("MkContainer");return(0,a.openBlock)(),(0,a.createBlock)(c,{"show-header":e.props.showHeader,naked:e.props.transparent},{header:(0,a.withCtx)((()=>[(0,a.createVNode)(d,{icon:e.faChartBar},null,8,["icon"]),(0,a.createTextVNode)((0,a.toDisplayString)(e.$ts._widgets.activity),1)])),func:(0,a.withCtx)((()=>[(0,a.createVNode)("button",{onClick:t[1]||(t[1]=t=>e.toggleView()),class:"_button"},[(0,a.createVNode)(d,{icon:e.faSort},null,8,["icon"])])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)("div",null,[e.fetching?((0,a.openBlock)(),(0,a.createBlock)(r,{key:0})):((0,a.openBlock)(),(0,a.createBlock)(a.Fragment,{key:1},[(0,a.withDirectives)((0,a.createVNode)(l,{data:[].concat(e.activity)},null,8,["data"]),[[a.vShow,0===e.props.view]]),(0,a.withDirectives)((0,a.createVNode)(p,{data:[].concat(e.activity)},null,8,["data"]),[[a.vShow,1===e.props.view]])],64))])])),_:1},8,["show-header","naked"])};const k=w},64935:(e,t,o)=>{var a=o(62960);"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,o(45346).Z)("ab0d80cc",a,!0,{})},27633:(e,t,o)=>{var a=o(20694);"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,o(45346).Z)("10a6633c",a,!0,{})},36833:(e,t,o)=>{var a=o(46795);"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals);(0,o(45346).Z)("469e9374",a,!0,{})}}]);